
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/information_theory/plot_it_dispersion_entropy_top_patterns.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_information_theory_plot_it_dispersion_entropy_top_patterns.py>`
        to download the full example code or to run this example in your browser via JupyterLite or Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_information_theory_plot_it_dispersion_entropy_top_patterns.py:


====================================
Dispersion Entropy with top patterns
====================================

Dispersion Entropy is computed by first discretising the signal and then extracting all the
dispersing patterns of given embedding dimension. The ditrubution of patterns determines the
dispersion entropy of signal. If signal have a few patterns with high repetitions compare to others
signal is less random which entails the low entropy. On the other hand, a random signal with no
patterns repetitions more than others leads to high entropy.

.. GENERATED FROM PYTHON SOURCE LINES 13-20

.. code-block:: Python


    import numpy as np
    import matplotlib.pyplot as plt
    import spkit as sp
    print('spkit-version',sp.__version__)






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    spkit-version 0.0.9.7




.. GENERATED FROM PYTHON SOURCE LINES 21-22

load sample EEG Signal

.. GENERATED FROM PYTHON SOURCE LINES 22-30

.. code-block:: Python


    X,ch_names = sp.load_data.eegSample()
    fs=128

    Xi = sp.filter_X(X[:,0],band=[1,20],btype='bandpass',verbose=0)
    print('EEG Sample : Shape',Xi.shape)
    t = np.arange(Xi.shape[0])/fs





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/nikeshbajaj/Library/CloudStorage/OneDrive-QueenMary,UniversityofLondon/Github/GIT3/Dev/SPKIT_Dev/SPKIT_DOC_7/examples/information_theory/plot_it_dispersion_entropy_top_patterns.py:23: DeprecationWarning: function eegSample will be deprecated in future version, due to naming convension, please use 'eeg_sample_14ch' for updated/improved functionality [spkit-0.0.9.7].
    EEG Sample : Shape (2048,)




.. GENERATED FROM PYTHON SOURCE LINES 31-32

Dispersion Entropy

.. GENERATED FROM PYTHON SOURCE LINES 32-81

.. code-block:: Python

    print('Dispersion Entropy with embeding dimention=4')
    print('-'*10)

    de,prob,patterns_dict,_,_= sp.dispersion_entropy(Xi,classes=10, scale=1, emb_dim=4, delay=1,return_all=True)
    print('Disperssion Entropy: ',de)



    PP = np.array([list(k)+[patterns_dict[k]] for k in patterns_dict])
    idx = np.argsort(PP[:,-1])[::-1]
    print('Top 10 Patterns')
    print(PP[idx[:10],:-1])

    Ptop = np.array(list(PP[idx,:-1]))
    idx2 = np.where(np.sum(np.abs(Ptop-Ptop.mean(1)[:,None]),1)>0)[0]

    fig = plt.figure(figsize=(12,6))
    plt.subplot(3,1,1)
    plt.plot(t,Xi)
    plt.xlim([0,t[-1]])
    plt.xlabel('time (s)')
    plt.grid()
    plt.title(f'Disperssion Entropy: {de}')
    #plt.ylabel('Signal')
    for i in range(10):
        plt.subplot(3,5,i+6)
        plt.plot(Ptop[idx2[i]].astype(int))
        plt.grid()
        plt.yticks(np.unique(Ptop[idx2[i]]))
        plt.title(f'#{i+1}')

    fig.suptitle('Dispersion Entropy and Top 10 non-flat Patterns')
    plt.tight_layout()
    plt.show()


    fig = plt.figure(figsize=(12,5))
    plt.subplot(121)
    plt.stem(np.arange(len(prob)),prob)
    plt.xlabel('pattern #')
    plt.ylabel('probability')
    plt.title(f'Disperssion Entropy: {de}')
    plt.subplot(122)
    plt.plot(Ptop[idx2[:10]].T,'--o')
    plt.xticks([0,1,2,3])
    plt.grid()
    plt.title('Top 10 non-flat Patterns')
    plt.tight_layout()
    plt.show()



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/information_theory/images/sphx_glr_plot_it_dispersion_entropy_top_patterns_001.png
         :alt: Dispersion Entropy and Top 10 non-flat Patterns, Disperssion Entropy: 3.4497910281190167, #1, #2, #3, #4, #5, #6, #7, #8, #9, #10
         :srcset: /auto_examples/information_theory/images/sphx_glr_plot_it_dispersion_entropy_top_patterns_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/information_theory/images/sphx_glr_plot_it_dispersion_entropy_top_patterns_002.png
         :alt: Disperssion Entropy: 3.4497910281190167, Top 10 non-flat Patterns
         :srcset: /auto_examples/information_theory/images/sphx_glr_plot_it_dispersion_entropy_top_patterns_002.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Dispersion Entropy with embeding dimention=4
    ----------
    Disperssion Entropy:  3.4497910281190167
    Top 10 Patterns
    [[6 6 6 6]
     [5 5 5 5]
     [6 5 5 5]
     [5 5 6 6]
     [6 6 5 5]
     [5 5 5 6]
     [6 6 6 5]
     [5 6 6 6]
     [4 4 4 4]
     [7 7 7 7]]





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.492 seconds)


.. _sphx_glr_download_auto_examples_information_theory_plot_it_dispersion_entropy_top_patterns.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/spkit/spkit/0.9.X?urlpath=lab/tree/notebooks/auto_examples/information_theory/plot_it_dispersion_entropy_top_patterns.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: lite-badge

      .. image:: images/jupyterlite_badge_logo.svg
        :target: ../../lite/lab/?path=auto_examples/information_theory/plot_it_dispersion_entropy_top_patterns.ipynb
        :alt: Launch JupyterLite
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_it_dispersion_entropy_top_patterns.ipynb <plot_it_dispersion_entropy_top_patterns.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_it_dispersion_entropy_top_patterns.py <plot_it_dispersion_entropy_top_patterns.py>`


.. include:: plot_it_dispersion_entropy_top_patterns.recommendations


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
