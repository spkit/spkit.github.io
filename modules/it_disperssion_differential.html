

<!DOCTYPE html>
<!-- data-theme below is forced to be "light" but should be changed if we use pydata-theme-sphinx in the future -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" data-content_root="../" data-theme="light"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en" data-content_root="../" data-theme="light">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="1.2. Dispersion and Differential Entropy" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://spkit.github.io/modules/it_disperssion_differential.html" />
<meta property="og:site_name" content="spkit" />
<meta property="og:description" content="Dispersion Entropy H_{de}(X): Background: Unlike usual entropy, Dispersion Entropy take the temporal dependency into accounts, same as Sample Entropy and Aproximate Entropy. It is Embeding Based En..." />
<meta property="og:image" content="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_pat_1.png" />
<meta property="og:image:alt" content="spkit" />
<meta name="description" content="Dispersion Entropy H_{de}(X): Background: Unlike usual entropy, Dispersion Entropy take the temporal dependency into accounts, same as Sample Entropy and Aproximate Entropy. It is Embeding Based En..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>1.2. Dispersion and Differential Entropy &mdash; spkit 0.0.9.7 documentation</title>
  
  <link rel="canonical" href="http://spkit.github.io/stable/modules/it_disperssion_differential.html" />

  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  <link rel="stylesheet" href="../_static/css/vendor/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../https://fonts.googleapis.com/css?family=Vibur" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyterlite_sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <script id="documentation_options" data-url_root="../"
    src="../_static/documentation_options.js"></script>
  <script src="../_static/js/vendor/jquery-3.6.3.slim.min.js"></script>
  <script src="../_static/js/details-permalink.js"></script>

  <link rel="stylesheet" href="../_static/css/vendor/nature_spkit.css" type="text/css" /> 


</head>

<body>
  





<!-- ('About us', pathto('about'), ''), -->


<div id="logo-banner">
  <div class="logo">
    <!-- <a href="../%23.html"><img src="_static/spkit_logo.png" alt="spkit logo"  border="0" /></a> -->
  <!-- <a href="#"><img src="_static/spkit_logo.png" alt="spkit logo"  border="0" /></a> -->
  <a href="../index.html"><img src="../_static/spkit_logo.png" alt="spkit logo"  border="0" /></a>
  </div>
  <div class="tags">
  <ul>
    <li>&#9672; Easy to use toolkit for signal processing and analysis</li>
    <li>&#9672; More of biomedical signal analysis with visualization</li>
    <li>&#9672; Includes basic machine learning models with visualization</li>
    <!-- <li>&#9672; Open source</li> -->
  </ul>
  </div>
  <div class="banner">
  <h2>Signal Processing Toolkit</h2>
  <h4><i>Simple and easy to use for signal analysis and predictive analysis</i></h4>
  </div>
</div>
<nav id="navbar" class="spk-docs-navbar navbar navbar-expand-md navbar-light bg-light py-0">
  <div class="container-fluid spk-docs-container px-0">
      <a class="navbar-brand py-0" href="../index.html">
        <img
          class="spk-brand-img"
          src="../_static/spkit_small_icon_v.png"
          alt="logo"/>
      </a>
    <button
      id="spk-navbar-toggler"
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="spk-navbar-collapse collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../index.html">Home</a>
        </li>
        <!-- <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../install.html">Install</a>
        </li> -->
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../user_guide.html">User Guide</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="classes.html">API</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../auto_examples/index.html">Examples</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../tutorials/index.html">Tutorials</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" target="_blank" rel="noopener noreferrer" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=">Discussion Forum</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../about.html">About Us</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="../getting_started.html" >Getting Started</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="../whats_new/v0.0.9.7.html" >What's new</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://github.com/nikeshbajaj/spkit" >GitHub</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://spkit.github.io/dev/index.html" target="_blank" rel="noopener noreferrer">Development</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=" >Get Involved</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://spkit.github.io/dev/versions.html" >Other Versions and Download</a>
        </li>
        <li class="nav-item dropdown nav-more-item-dropdown">
          <a class="spk-nav-link nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="spk-nav-dropdown-item dropdown-item" href="../getting_started.html" >Getting Started</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="../whats_new/v0.0.9.7.html" >What's new</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://github.com/nikeshbajaj/spkit" >GitHub</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://spkit.github.io/dev/index.html" target="_blank" rel="noopener noreferrer">Development</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=" >Get Involved</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://spkit.github.io/dev/versions.html" >Other Versions and Download</a>
          </div>
        </li>
      </ul>
      <div id="searchbox" role="search">
          <div class="searchformwrapper">
          <form class="search" action="../search.html" method="get">
            <input class="spk-search-text-input" type="text" name="q" aria-labelledby="searchlabel" />
            <input class="spk-search-text-btn" type="submit" value="Go" />
          </form>
          </div>
      </div>
      <a class ="nav-more-item-dropdown">
      <font size="4em" style="margin: 5px 5px 0px 5px;color:rgb(0, 0, 0)">V</font>
      </a>
      <div class="nav-item dropdown nav-more-item-dropdown-vs">
        <a class="sp-nav-link nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <font color="black">0.0.9.7 (latest)</font>
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="sp-nav-dropdown-item dropdown-item" href="../index.html" >0.0.9.7 (latest)</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../V/0.0.9.6/index.html" >0.0.9.6</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../V/0.0.9.5/index.html" >0.0.9.5</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../V/0.0.9.4/index.html" >0.0.9.4</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../V/0.0.9.3/index.html" >0.0.9.3</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../V/0.0.9.2/index.html" >0.0.9.2</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../V/0.0.9.1/index.html" >0.0.9.1</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="https://github.com/Nikeshbajaj/spkit/releases" >More</a>
        </div>
      </div>
    </div>
  </div>
</nav>
  <div class="d-flex" id="spk-doc-wrapper" class="border-right">
    <input type="checkbox" name="spk-toggle-checkbox" id="spk-toggle-checkbox">
    <label id="spk-sidemenu-toggle" class="spk-btn-toggle-toc btn spk-btn-primary" for="spk-toggle-checkbox">Toggle
      Menu</label>
      <div id="spk-sidebar-top-logoimg">
        <a href="../index.html">
          <img class="spk-brand-img-side" src="../_static/spkit_logo.png" alt="spkit logo"  border="0" />
        </a>
      </div>
    <div id="spk-sidebar-wrapper" class="border-right">
      <div class="spk-sidebar-top-content">
        <hr style="margin: 0 0 10px 0" />
        <div class="alert alert-danger p-1 mb-2" role="alert">
          <p class="text-center mb-0">
            <strong>SpKit 0.0.9.7</strong><br />
            <!-- <a class="reference external" href="https://pypi.org/project/spkit" target="_blank"><img alt="GitHub release (latest SemVer)" src="https://img.shields.io/github/v/release/Nikeshbajaj/spkit?label=latest%20version&style=plastic"></a> -->
            <a class="reference external" href="https://pepy.tech/project/spkit" target="_blank"><img
                src="https://static.pepy.tech/personalized-badge/spkit?period=total&amp;units=international_system&amp;left_color=black&amp;right_color=orange&amp;left_text=downloads"
                alt="PyPI - Downloads" /></a>
            <a class="reference external" href="https://pypi.python.org/pypi/spkit" target="_blank"><img
                alt="PyPI - Downloads" src="https://img.shields.io/pypi/dm/spkit?style=plastic"></a>
            <!-- <a href="http://spkit.github.io/dev/versions.html">Other versions</a> -->
          </p>
        </div>
        <div class="alert alert-warning p-1 mb-2" role="alert">
          <p class="text-center mb-0">
            Please <a class="font-weight-bold" href="../about.html#citing">
              <string>cite us</string>
            </a> if you use the software.
          </p>
        </div>
        <div class="btn-group w-100 mb-2" role="group" aria-label="rellinks">
          <a href="it_entropy.html" role="button" class="btn spk-btn-rellink py-1"
            spk-rellink-tooltip="1.1. Entropy">Prev</a><a href=" information_theory.html" role="button" class="btn spk-btn-rellink py-1"
            spk-rellink-tooltip="1. Information Theory">Up</a>
          <a href="it_apps.html" role="button" class="btn spk-btn-rellink py-1"
            spk-rellink-tooltip="1.3. Applications">Next</a>
        </div>
        <hr>
      </div>
      <div class=" spk-sidebar-toc-wrapper">
          <!-- <div class="btn-group w-100 mb-2" role="group" aria-label="rellinks">
            <a href="it_entropy.html" role="button" class="btn spk-btn-rellink py-1"
              spk-rellink-tooltip="1.1. Entropy">Prev</a><a href=" information_theory.html" role="button" class="btn spk-btn-rellink py-1"
              spk-rellink-tooltip="1. Information Theory">Up</a>
            <a href="it_apps.html" role="button" class="btn spk-btn-rellink py-1"
              spk-rellink-tooltip="1.3. Applications">Next</a>
          </div>
          <hr> -->
          <div class="spk-sidebar-toc">
            <ul>
<li><a class="reference internal" href="#">1.2. Dispersion and Differential Entropy</a><ul>
<li><a class="reference internal" href="#dispersion-entropy-h-de-x">1.2.1. Dispersion Entropy <span class="math notranslate nohighlight">\(H_{de}(X)\)</span></a><ul>
<li><a class="reference internal" href="#background">1.2.1.1. Background</a></li>
<li><a class="reference internal" href="#an-example">1.2.1.2. An Example</a></li>
<li><a class="reference internal" href="#embedding-dimension-4">1.2.1.3. Embedding dimension 4</a></li>
<li><a class="reference internal" href="#dispersion-entropy-with-sliding-window">1.2.1.4. Dispersion Entropy with sliding window</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multi-scale-dispersion-entropy">1.2.2. Multi-scale Dispersion Entropy</a><ul>
<li><a class="reference internal" href="#dispersion-entropy-multiscale">1.2.2.1. Dispersion Entropy multiscale</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dispersion-entropy-shannon-entropy">1.2.3. Dispersion Entropy &amp; Shannon Entropy</a></li>
<li><a class="reference internal" href="#dispersion-entropy-sample-entropy">1.2.4. Dispersion Entropy &amp; Sample Entropy</a></li>
<li><a class="reference internal" href="#differential-entropy-functions-h-partial-cdot">1.2.5. Differential Entropy Functions <span class="math notranslate nohighlight">\(H_{\partial}(\cdot)\)</span></a></li>
<li><a class="reference internal" href="#differential-entropy-h-partial-x">1.2.6. Differential Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X)\)</span></a></li>
<li><a class="reference internal" href="#self-conditional-entropy-h-partial-x-i-1-x-i">1.2.7. Self-Conditional Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X_{i+1}|X_{i})\)</span></a></li>
<li><a class="reference internal" href="#conditional-entropy-h-partial-x-i-1-x-i-y-i">1.2.8. Conditional Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X_{i+1}|X_{i},Y_{i})\)</span></a></li>
<li><a class="reference internal" href="#joint-entropy-h-partial-x-y">1.2.9. Joint Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X,Y)\)</span></a></li>
<li><a class="reference internal" href="#self-mutual-information-i-partial-x-i-1-x-i">1.2.10. Self-Mutual Information <span class="math notranslate nohighlight">\(I_{\partial}(X_{i+1}|X_{i})\)</span></a></li>
<li><a class="reference internal" href="#mutual-information-i-partial-x-y">1.2.11. Mutual Information <span class="math notranslate nohighlight">\(I_{\partial}(X,Y)\)</span></a></li>
</ul>
</li>
</ul>

          </div>
      </div>
      <br>
      <br>
      <br>
      <br>
      <br>
    </div>
    <div id="spk-page-content-wrapper">
      <div class="spk-page-content container-fluid body px-md-3" role="main">
        
  <section id="dispersion-and-differential-entropy">
<span id="dis-entropy"></span><h1><span class="section-number">1.2. </span>Dispersion and Differential Entropy<a class="headerlink" href="#dispersion-and-differential-entropy" title="Link to this heading">¶</a></h1>
<section id="dispersion-entropy-h-de-x">
<span id="entropy-dispersion"></span><h2><span class="section-number">1.2.1. </span>Dispersion Entropy <span class="math notranslate nohighlight">\(H_{de}(X)\)</span><a class="headerlink" href="#dispersion-entropy-h-de-x" title="Link to this heading">¶</a></h2>
<section id="background">
<h3><span class="section-number">1.2.1.1. </span>Background<a class="headerlink" href="#background" title="Link to this heading">¶</a></h3>
<p>Unlike usual entropy, Dispersion Entropy take the temporal dependency into accounts, same as Sample Entropy and Aproximate Entropy. It is Embeding Based Entropy function. The idea of Dispersion is almost same as Sample and Aproximate, which is to extract Embeddings, estimate their distribuation and compute entropy. However, there is a fine detail that make dispersion entropy more usuful.</p>
<ul class="simple">
<li><p>First, is to map the distribuation original signal to uniform (using CDF), then divide them into n-classes. This is same as done for quantization process of any normally distributed signal, such as speech. In quantization, this mapping helps to minimize the quantization error, by assiging small quantization steps for samples with high density and large for low. Think this in a way, if in a signal, large number of samples belongs to a range (-0.1, 0.1), near to zero, your almost all the embeddings will have at least one value that is in that range. CDF mapping will avoid that. In this python implimentation, we have included other mapping functions, which are commonly used in speech processing, i.e. A-Law, and µ-Law, with parameter A and µ to control the mapping.</p></li>
<li><p>Second, it allows to extract Embedding with delay factor, i.e. if delay is 2, an embeding is continues samples skiping everu other sample. which is kind of decimation. This helps if your signal is sampled at very high sampling frequecy, i.e. super smooth in local region. Consider you hhave a signal with very high smapling rate, then many of the continues samples will have similar values, which will lead to have a very high number of contant embeddings.</p></li>
<li><p>Third, actuall not so much of third, but an alternative to deal with signal with very high sampling rate, is by scale factor, which is nothing but a decimator.</p></li>
</ul>
</section>
<section id="an-example">
<h3><span class="section-number">1.2.1.2. </span>An Example<a class="headerlink" href="#an-example" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">optical_sample</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span><span class="o">/</span><span class="n">fs</span>
<span class="n">H_de1</span><span class="p">,</span> <span class="n">prob1</span>  <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DE of x1 = &#39;</span><span class="p">,</span><span class="n">H_de1</span><span class="p">)</span>
</pre></div>
</div>
<p>2.271749287746759</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>

<span class="n">X</span><span class="p">,</span><span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">load_data</span><span class="o">.</span><span class="n">eegSample</span><span class="p">()</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">128</span>

<span class="c1">#filtering</span>
<span class="n">Xf</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">filter_X</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">band</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">Xi</span> <span class="o">=</span> <span class="n">Xf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># only one channel</span>

<span class="n">de</span><span class="p">,</span><span class="n">prob</span><span class="p">,</span><span class="n">patterns_dict</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">de</span><span class="p">)</span>
</pre></div>
</div>
<p>2.271749287746759</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Important Note on Log base
check following note</p>
<p><strong>Important Note:  Log base</strong></p>
<p>The Entropy here is computed as  <span class="math notranslate nohighlight">\(-\sum p(x)log_e (p(x))\)</span> , natural log. <strong>To convert to log2, simply divide the value with np.log(2)</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>3.2774414315752844</p>
</div>
<p><strong>Probability of all the patterns found</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;pattern #&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_pat_1.png" src="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_pat_1.png" />
<p>Pattern dictionary</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">patterns_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">18</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">23</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>top 10 patters</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="n">patterns_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">patterns_dict</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">PP</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">PP</span><span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="mi">10</span><span class="p">],:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference external image-reference" href="../auto_examples/information_theory/plot_it_dispersion_entropy_eeg_emb2.html"><img alt="../_images/sphx_glr_plot_it_dispersion_entropy_eeg_emb2_001.png" src="../_images/sphx_glr_plot_it_dispersion_entropy_eeg_emb2_001.png" style="width: 700.0px; height: 210.0px;" /></a>
</figure>
</section>
<section id="embedding-dimension-4">
<h3><span class="section-number">1.2.1.3. </span>Embedding dimension 4<a class="headerlink" href="#embedding-dimension-4" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de</span><span class="p">,</span><span class="n">prob</span><span class="p">,</span><span class="n">patterns_dict</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">de</span>
</pre></div>
</div>
<p>4.86637389336799</p>
<p>top 10 patters</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="n">patterns_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">patterns_dict</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">PP</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">PP</span><span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="mi">10</span><span class="p">],:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
</pre></div>
</div>
<p>top-10, non-constant pattern</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ptop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">PP</span><span class="p">[</span><span class="n">idx</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">idx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ptop</span><span class="o">-</span><span class="n">Ptop</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ptop</span><span class="p">[</span><span class="n">idx2</span><span class="p">[:</span><span class="mi">10</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;--o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/docs/figures/DE_Patt1.png" src="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/docs/figures/DE_Patt1.png" />
<figure class="align-center">
<a class="reference external image-reference" href="../auto_examples/information_theory/plot_it_dispersion_entropy_top_patterns.html"><img alt="../_images/sphx_glr_plot_it_dispersion_entropy_top_patterns_001.png" src="../_images/sphx_glr_plot_it_dispersion_entropy_top_patterns_001.png" style="width: 600.0px; height: 300.0px;" /></a>
</figure>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ptop</span><span class="p">[</span><span class="n">idx2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/docs/figures/DE_Patt2.png" src="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/docs/figures/DE_Patt2.png" />
</section>
<section id="dispersion-entropy-with-sliding-window">
<h3><span class="section-number">1.2.1.4. </span>Dispersion Entropy with sliding window<a class="headerlink" href="#dispersion-entropy-with-sliding-window" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de_temporal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">win</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="k">while</span> <span class="n">win</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">Xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">de</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">Xi</span><span class="p">[</span><span class="n">win</span><span class="p">],</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">win</span><span class="o">+=</span><span class="mi">16</span>
    <span class="n">de_temporal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">de</span><span class="p">)</span><span class="n">x</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">de_temporal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">de_temporal</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dispersion Entropy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_temp_1.png" src="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_temp_1.png" />
</section>
</section>
<section id="multi-scale-dispersion-entropy">
<h2><span class="section-number">1.2.2. </span>Multi-scale Dispersion Entropy<a class="headerlink" href="#multi-scale-dispersion-entropy" title="Link to this heading">¶</a></h2>
<section id="dispersion-entropy-multiscale">
<h3><span class="section-number">1.2.2.1. </span>Dispersion Entropy multiscale<a class="headerlink" href="#dispersion-entropy-multiscale" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">scl</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]:</span>
   <span class="n">de</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scl</span><span class="p">,</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sacle: </span><span class="si">{</span><span class="n">scl</span><span class="si">}</span><span class="s1">, </span><span class="se">\t</span><span class="s1">: DE: </span><span class="si">{</span><span class="n">de</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sacle</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>    <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.271749287746759</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>    <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.5456280627759336</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>    <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.6984938704051236</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>    <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.682837351130069</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>   <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.5585556625642476</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>   <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.7480275694000103</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>   <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.4767472897625806</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy_multiscale_refined</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">de</span><span class="p">)</span>
</pre></div>
</div>
<p>2.543855087400606</p>
<figure class="align-center">
<a class="reference external image-reference" href="../auto_examples/information_theory/plot_it_dispersion_entropy_top_patterns.html"><img alt="../_images/sphx_glr_plot_it_dispersion_entropy_top_patterns_001.png" src="../_images/sphx_glr_plot_it_dispersion_entropy_top_patterns_001.png" style="width: 600.0px; height: 300.0px;" /></a>
</figure>
</section>
</section>
<section id="dispersion-entropy-shannon-entropy">
<h2><span class="section-number">1.2.3. </span>Dispersion Entropy &amp; Shannon Entropy<a class="headerlink" href="#dispersion-entropy-shannon-entropy" title="Link to this heading">¶</a></h2>
</section>
<section id="dispersion-entropy-sample-entropy">
<h2><span class="section-number">1.2.4. </span>Dispersion Entropy &amp; Sample Entropy<a class="headerlink" href="#dispersion-entropy-sample-entropy" title="Link to this heading">¶</a></h2>
</section>
<section id="differential-entropy-functions-h-partial-cdot">
<h2><span class="section-number">1.2.5. </span>Differential Entropy Functions <span class="math notranslate nohighlight">\(H_{\partial}(\cdot)\)</span><a class="headerlink" href="#differential-entropy-functions-h-partial-cdot" title="Link to this heading">¶</a></h2>
<p>Differential Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X)\)</span></p>
<blockquote>
<div><p>Differential Entropy of Normally distribuated Multivariant X</p>
<p>for</p>
<div class="math notranslate nohighlight">
\[x ∼ N(μ,Σ)\]</div>
<p>entropy in nats</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[H_{\partial}(x) =  (1/2)ln|Σ| + (1/2)n + (n/2)ln(2π)\]</div>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(H_{\partial}(X)\)</span></p>
<p><span class="math notranslate nohighlight">\((1/2)n + (n/2)ln(2π)\)</span> =&gt; are constant values for fixed dimension</p>
</div></blockquote>
</section>
<section id="differential-entropy-h-partial-x">
<h2><span class="section-number">1.2.6. </span>Differential Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X)\)</span><a class="headerlink" href="#differential-entropy-h-partial-x" title="Link to this heading">¶</a></h2>
<p>Differential Entropy of Normally distribuated Multivariant X</p>
<p><span class="math notranslate nohighlight">\(H_{\partial}(X)\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">optical_sample</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span><span class="o">/</span><span class="n">fs</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="c1"># create multi-dimensional space signals</span>
<span class="n">X0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Compute Differential Entropy</span>
<span class="n">Hd0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_differential</span><span class="p">(</span><span class="n">X0</span><span class="p">)</span>
<span class="n">Hd1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_differential</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Differential Entropy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; - x0: &#39;</span><span class="p">,</span><span class="n">Hd0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; - x1: &#39;</span><span class="p">,</span><span class="n">Hd1</span><span class="p">)</span>
<span class="c1"># Or Compute directly - Compute Differential Entropy</span>
<span class="n">Hd0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_differential</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">is_multidim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Hd1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_differential</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">is_multidim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Differential Entropy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; - x0: &#39;</span><span class="p">,</span><span class="n">Hd0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; - x1: &#39;</span><span class="p">,</span><span class="n">Hd1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="self-conditional-entropy-h-partial-x-i-1-x-i">
<h2><span class="section-number">1.2.7. </span>Self-Conditional Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X_{i+1}|X_{i})\)</span><a class="headerlink" href="#self-conditional-entropy-h-partial-x-i-1-x-i" title="Link to this heading">¶</a></h2>
<p>Self-Conditional Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X_{i+1}|X_i)\)</span></p>
<blockquote>
<div><p>Self-Conditional Entropy</p>
<p>Information of <span class="math notranslate nohighlight">\(X(i+1)\)</span> given <span class="math notranslate nohighlight">\(X(i)\)</span></p>
<div class="math notranslate nohighlight">
\[H_{\partial}(X_{i+1}|X_i) = H_{\partial}(X_{i+1}, X_i) - H_{\partial}(X_i)\]</div>
<p>using::
.. math:: H(X|Y) =  H(X, Y) - H(Y)</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">x</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">optical_sample</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">#x = sp.add_noise(x,snr_db=20)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H_x1x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_cond_self</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">present_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Self-Conditional Entropy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  H(X(i+1)|X(i)) = </span><span class="si">{</span><span class="n">H_x1x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="conditional-entropy-h-partial-x-i-1-x-i-y-i">
<h2><span class="section-number">1.2.8. </span>Conditional Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X_{i+1}|X_{i},Y_{i})\)</span><a class="headerlink" href="#conditional-entropy-h-partial-x-i-1-x-i-y-i" title="Link to this heading">¶</a></h2>
<p>Conditional Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X_{i+1}|X_i,Y_i)\)</span></p>
<blockquote>
<div><p>Conditional Entropy</p>
<p>Information of <span class="math notranslate nohighlight">\(X(i+1)\)</span> given <span class="math notranslate nohighlight">\(X(i)\)</span> and <span class="math notranslate nohighlight">\(Y(i)\)</span></p>
<div class="math notranslate nohighlight">
\[H_{\partial}(X_{i+1}|X_i,Y_i) = H(X_{i+1},X_i,Y_i) - H(X_i,Y_i)\]</div>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#sp.entropy_diff_cond</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">X</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">eeg_sample_14ch</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span><span class="n">snr_db</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">H_xy1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_cond</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">present_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">H_xy2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_cond</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">present_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">H_y1x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_cond</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span><span class="n">X1</span><span class="p">,</span><span class="n">present_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">H_y2x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_cond</span><span class="p">(</span><span class="n">Y2</span><span class="p">,</span><span class="n">X1</span><span class="p">,</span><span class="n">present_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Conditional Entropy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(X1|Y1) = </span><span class="si">{</span><span class="n">H_xy1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(X1|Y2) = </span><span class="si">{</span><span class="n">H_xy2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(Y1|X1) = </span><span class="si">{</span><span class="n">H_y1x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(Y2|X1) = </span><span class="si">{</span><span class="n">H_y2x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="joint-entropy-h-partial-x-y">
<h2><span class="section-number">1.2.9. </span>Joint Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X,Y)\)</span><a class="headerlink" href="#joint-entropy-h-partial-x-y" title="Link to this heading">¶</a></h2>
<p>Differential Joint Entropy with</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[H_{\partial}(X,Y)\]</div>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1</span>
<span class="c1">#sp.entropy_diff_joint</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">X</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">eeg_sample_14ch</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span><span class="n">snr_db</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">H_xy1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_joint</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">)</span>
<span class="n">H_xy2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_joint</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Conditional Entropy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(X1,Y1) = </span><span class="si">{</span><span class="n">H_xy1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(X1,Y2) = </span><span class="si">{</span><span class="n">H_xy2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">#############################</span>
<span class="c1"># Example 2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">X</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">eeg_sample_14ch</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1">#x1 = x1[:,None]</span>
<span class="c1">#y1 = y1[:,None]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="n">snr_db</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">H_xy1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_joint</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span>
<span class="n">H_xy2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_joint</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Conditional Entropy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(X1,Y1) = </span><span class="si">{</span><span class="n">H_xy1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(X1,Y2) = </span><span class="si">{</span><span class="n">H_xy2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Joint-Conditional Entropy <span class="math notranslate nohighlight">\(H_{\partial}(X_{i+1},Y_{i+1}|X_i,Y_i)\)</span></p>
<blockquote>
<div><p>Joint-Conditional Entropy</p>
<div class="math notranslate nohighlight">
\[H_{\partial}(X_{i+1},Y_{i+1}|X_i,Y_i) = H(X_{i+1},Y_{i+1},X_i,Y_i) - H(X_i,Y_i)\]</div>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">X</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">eeg_sample_14ch</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="c1"># Example 1</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span><span class="n">snr_db</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">H_xy1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_joint_cond</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">)</span>
<span class="n">H_xy2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">entropy_diff_joint_cond</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Conditional Entropy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(X1(i+1),Y1(i+1) | X1(i),Y1(i)) = </span><span class="si">{</span><span class="n">H_xy1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- H(X1(i+1),Y2(i+1) | X1(i),Y2(i)) = </span><span class="si">{</span><span class="n">H_xy2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="self-mutual-information-i-partial-x-i-1-x-i">
<h2><span class="section-number">1.2.10. </span>Self-Mutual Information <span class="math notranslate nohighlight">\(I_{\partial}(X_{i+1}|X_{i})\)</span><a class="headerlink" href="#self-mutual-information-i-partial-x-i-1-x-i" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#sp.mutual_info_diff_self</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">X</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">eeg_sample_14ch</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="c1"># Example 1</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">snr_db</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">I_x1x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">mutual_info_diff_self</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="n">I_y1y</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">mutual_info_diff_self</span><span class="p">(</span><span class="n">Y1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Self-Mutual Information&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- I(X(i+1)| X(i)) = </span><span class="si">{</span><span class="n">I_x1x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- I(Y(i+1)| Y(i)) = </span><span class="si">{</span><span class="n">I_y1y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="mutual-information-i-partial-x-y">
<h2><span class="section-number">1.2.11. </span>Mutual Information <span class="math notranslate nohighlight">\(I_{\partial}(X,Y)\)</span><a class="headerlink" href="#mutual-information-i-partial-x-y" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#sp.mutual_info_diff</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">X</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">eeg_sample_14ch</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="c1"># Example 1</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal_delayed_space</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">emb_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span><span class="n">snr_db</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">I_xy1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">mutual_info_diff</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">)</span>
<span class="n">I_xy2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">mutual_info_diff</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mutual-Information&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- I(X1,Y1) = </span><span class="si">{</span><span class="n">I_xy1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- I(X1,Y2) = </span><span class="si">{</span><span class="n">I_xy2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">References:</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://statproofbook.github.io/P/mvn-dent.html">https://statproofbook.github.io/P/mvn-dent.html</a></p>
</aside>
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution">https://en.wikipedia.org/wiki/Multivariate_normal_distribution</a></p>
</aside>
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Differential_entropy">https://en.wikipedia.org/wiki/Differential_entropy</a></p>
</aside>
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<p>Gokhale, DV; Ahmed, NA; Res, BC; Piscataway, NJ (May 1989). “Entropy Expressions and Their Estimators for Multivariate Distributions”. IEEE Transactions on Information Theory. 35 (3): 688–692. doi:10.1109/18.30996.</p>
</aside>
</aside>
</aside>
</section>
</section>


      </div>
      <div class="container">
        <footer class="spk-content-footer">
          &copy; 2019 - 2024, spkit developers (BSD License).
          <!-- -->
          <!-- <a href="../_sources/modules/it_disperssion_differential.rst.txt" rel="nofollow">Show this page source</a> -->
          <!-- -->
        </footer>
      </div>

      <div class="container-fluid py-3">
        <hr>
        <div class="container spk-landing-container">
              <a class="spk-footer-funding-link" href="../about.html">
              <div class="text-center">
                      <p class="mt-2">
                        Spkit developed in collabration with other projects:
                      </p>
                      <a href="https://PhyAAt.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../_static/phyaat_logo.png" title="PhyAAt"></a>
                      <a href="https://PyLFSR.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../_static/pylfsr_logo.png" title="PyLFSR" ></a>
                      <a href="https://MLEndDatasets.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../_static/mlend_logo.png" title="MLEnd-Datasets" ></a>
                      <a href='https://clustrmaps.com/site/1b9h1'  title='Visit tracker'><img src='//clustrmaps.com/map_v2.png?cl=46b0cb&w=a&t=n&d=eQr8xSBiKVuSq6m0psK-Ey9TZ7rLzjRX-MpatyfFGQI&co=ffffff&ct=000000' width="30"/></a>

              </div>
              </a>
              <!-- <div style="width:3px;">
                <a href="https://clustrmaps.com/site/1b9h1"  title="Visit tracker"><img src="//www.clustrmaps.com/map_v2.png?d=eQr8xSBiKVuSq6m0psK-Ey9TZ7rLzjRX-MpatyfFGQI&cl=ffffff" /></a>  
              </div> -->
        </div>
      </div>
    </div>
  </div>
  <script src="../_static/js/vendor/bootstrap.min.js"></script>
  
<script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-59299155-3', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<!-- 
<script defer data-domain="scikit-learn.org" src="https://views.scientific-python.org/js/script.js">
</script>
 -->

<script src="../_static/clipboard.min.js"></script>
<script src="../_static/copybutton.js"></script>

<script>
$(document).ready(function() {
    /* Add a [>>>] button on the top-right corner of code samples to hide
     * the >>> and ... prompts and the output and thus make the code
     * copyable. */
    var div = $('.highlight-python .highlight,' +
                '.highlight-python3 .highlight,' +
                '.highlight-pycon .highlight,' +
		        '.highlight-default .highlight')
    var pre = div.find('pre');

    // get the styles from the current theme
    pre.parent().parent().css('position', 'relative');

    // create and add the button to all the code blocks that contain >>>
    div.each(function(index) {
        var jthis = $(this);
        // tracebacks (.gt) contain bare text elements that need to be
        // wrapped in a span to work with .nextUntil() (see later)
        jthis.find('pre:has(.gt)').contents().filter(function() {
            return ((this.nodeType == 3) && (this.data.trim().length > 0));
        }).wrap('<span>');
    });

	/*** Add permalink buttons next to glossary terms ***/
	$('dl.glossary > dt[id]').append(function() {
		return ('<a class="headerlink" href="#' +
			    this.getAttribute('id') +
			    '" title="Permalink to this term">¶</a>');
	});
});

</script>
    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    
</body>

</html>