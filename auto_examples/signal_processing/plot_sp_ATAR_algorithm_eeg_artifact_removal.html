

<!DOCTYPE html>
<!-- data-theme below is forced to be "light" but should be changed if we use pydata-theme-sphinx in the future -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" data-content_root="../../" data-theme="light"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en" data-content_root="../../" data-theme="light">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="ATAR: Automatic and Tunable Artifact Removal Algorithm" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://spkit.github.io/auto_examples/signal_processing/plot_sp_ATAR_algorithm_eeg_artifact_removal.html" />
<meta property="og:site_name" content="spkit" />
<meta property="og:description" content="ATAR: Automatic and Tunable Artifact Removal Algorithm <div class=”toc”><ul class=”toc-item”><li><span><a href=”#ATAR:-Automatic-and-Tunable-Artifact-Removal-Algorithm” data-toc-modified-id=”ATAR:-..." />
<meta property="og:image" content="https://github.com/spkit/spkit.github.io/blob/master/assets/logo/logo.png" />
<meta property="og:image:alt" content="spkit" />
<meta name="description" content="ATAR: Automatic and Tunable Artifact Removal Algorithm <div class=”toc”><ul class=”toc-item”><li><span><a href=”#ATAR:-Automatic-and-Tunable-Artifact-Removal-Algorithm” data-toc-modified-id=”ATAR:-..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>ATAR: Automatic and Tunable Artifact Removal Algorithm &mdash; spkit 0.0.9.7 documentation</title>
  
  <link rel="canonical" href="http://spkit.github.io/stable/auto_examples/signal_processing/plot_sp_ATAR_algorithm_eeg_artifact_removal.html" />

  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  <link rel="stylesheet" href="../../_static/css/vendor/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../../https://fonts.googleapis.com/css?family=Vibur" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyterlite_sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <script id="documentation_options" data-url_root="../../"
    src="../../_static/documentation_options.js"></script>
  <script src="../../_static/js/vendor/jquery-3.6.3.slim.min.js"></script>
  <script src="../../_static/js/details-permalink.js"></script>

  <link rel="stylesheet" href="../../_static/css/vendor/nature_spkit.css" type="text/css" /> 


</head>

<body>
  





<!-- ('About us', pathto('about'), ''), -->


<div id="logo-banner">
  <div class="logo">
    <!-- <a href="../../%23.html"><img src="_static/spkit_logo.png" alt="spkit logo"  border="0" /></a> -->
  <!-- <a href="#"><img src="_static/spkit_logo.png" alt="spkit logo"  border="0" /></a> -->
  <a href="../../index.html"><img src="../../_static/spkit_logo.png" alt="spkit logo"  border="0" /></a>
  </div>
  <div class="tags">
  <ul>
    <li>&#9672; Easy to use toolkit for signal processing and analysis</li>
    <li>&#9672; More of biomedical signal analysis with visualization</li>
    <li>&#9672; Includes basic machine learning models with visualization</li>
    <!-- <li>&#9672; Open source</li> -->
  </ul>
  </div>
  <div class="banner">
  <h2>Signal Processing Toolkit</h2>
  <h4><i>Simple and easy to use for signal analysis and predictive analysis</i></h4>
  </div>
</div>
<nav id="navbar" class="spk-docs-navbar navbar navbar-expand-md navbar-light bg-light py-0">
  <div class="container-fluid spk-docs-container px-0">
      <a class="navbar-brand py-0" href="../../index.html">
        <img
          class="spk-brand-img"
          src="../../_static/spkit_small_icon_v.png"
          alt="logo"/>
      </a>
    <button
      id="spk-navbar-toggler"
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="spk-navbar-collapse collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../index.html">Home</a>
        </li>
        <!-- <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../install.html">Install</a>
        </li> -->
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../user_guide.html">User Guide</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../modules/classes.html">API</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../index.html">Examples</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../tutorials/index.html">Tutorials</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" target="_blank" rel="noopener noreferrer" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=">Discussion Forum</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../about.html">About Us</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="../../getting_started.html" >Getting Started</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="../../whats_new/v0.0.9.7.html" >What's new</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://github.com/nikeshbajaj/spkit" >GitHub</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://spkit.github.io/dev/index.html" target="_blank" rel="noopener noreferrer">Development</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=" >Get Involved</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://spkit.github.io/dev/versions.html" >Other Versions and Download</a>
        </li>
        <li class="nav-item dropdown nav-more-item-dropdown">
          <a class="spk-nav-link nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="spk-nav-dropdown-item dropdown-item" href="../../getting_started.html" >Getting Started</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="../../whats_new/v0.0.9.7.html" >What's new</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://github.com/nikeshbajaj/spkit" >GitHub</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://spkit.github.io/dev/index.html" target="_blank" rel="noopener noreferrer">Development</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=" >Get Involved</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://spkit.github.io/dev/versions.html" >Other Versions and Download</a>
          </div>
        </li>
      </ul>
      <div id="searchbox" role="search">
          <div class="searchformwrapper">
          <form class="search" action="../../search.html" method="get">
            <input class="spk-search-text-input" type="text" name="q" aria-labelledby="searchlabel" />
            <input class="spk-search-text-btn" type="submit" value="Go" />
          </form>
          </div>
      </div>
      <a class ="nav-more-item-dropdown">
      <font size="4em" style="margin: 5px 5px 0px 5px;color:rgb(0, 0, 0)">V</font>
      </a>
      <div class="nav-item dropdown nav-more-item-dropdown-vs">
        <a class="sp-nav-link nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <font color="black">0.0.9.7 (latest)</font>
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="sp-nav-dropdown-item dropdown-item" href="../../index.html" >0.0.9.7 (latest)</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.6/index.html" >0.0.9.6</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.5/index.html" >0.0.9.5</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.4/index.html" >0.0.9.4</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.3/index.html" >0.0.9.3</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.2/index.html" >0.0.9.2</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.1/index.html" >0.0.9.1</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="https://github.com/Nikeshbajaj/spkit/releases" >More</a>
        </div>
      </div>
    </div>
  </div>
</nav>
  <div class="d-flex" id="spk-doc-wrapper" class="border-right">
    <input type="checkbox" name="spk-toggle-checkbox" id="spk-toggle-checkbox">
    <label id="spk-sidemenu-toggle" class="spk-btn-toggle-toc btn spk-btn-primary" for="spk-toggle-checkbox">Toggle
      Menu</label>
      <div id="spk-sidebar-top-logoimg">
        <a href="../../index.html">
          <img class="spk-brand-img-side" src="../../_static/spkit_logo.png" alt="spkit logo"  border="0" />
        </a>
      </div>
    <div id="spk-sidebar-wrapper" class="border-right">
      <div class="spk-sidebar-top-content">
        <hr style="margin: 0 0 10px 0" />
        <div class="alert alert-danger p-1 mb-2" role="alert">
          <p class="text-center mb-0">
            <strong>SpKit 0.0.9.7</strong><br />
            <!-- <a class="reference external" href="https://pypi.org/project/spkit" target="_blank"><img alt="GitHub release (latest SemVer)" src="https://img.shields.io/github/v/release/Nikeshbajaj/spkit?label=latest%20version&style=plastic"></a> -->
            <a class="reference external" href="https://pepy.tech/project/spkit" target="_blank"><img
                src="https://static.pepy.tech/personalized-badge/spkit?period=total&amp;units=international_system&amp;left_color=black&amp;right_color=orange&amp;left_text=downloads"
                alt="PyPI - Downloads" /></a>
            <a class="reference external" href="https://pypi.python.org/pypi/spkit" target="_blank"><img
                alt="PyPI - Downloads" src="https://img.shields.io/pypi/dm/spkit?style=plastic"></a>
            <!-- <a href="http://spkit.github.io/dev/versions.html">Other versions</a> -->
          </p>
        </div>
        <div class="alert alert-warning p-1 mb-2" role="alert">
          <p class="text-center mb-0">
            Please <a class="font-weight-bold" href="../../about.html#citing">
              <string>cite us</string>
            </a> if you use the software.
          </p>
        </div>
        <div class="btn-group w-100 mb-2" role="group" aria-label="rellinks">
          <a href="#" role="button" class="btn spk-btn-rellink py-1 disabled"">Prev</a>
          <a href="#" role="button" class="btn spk-btn-rellink disabled py-1">Up</a>
          <a href="#" role="button" class="btn spk-btn-rellink py-1 disabled"">Next</a>
        </div>
        <hr>
      </div>
      <div class=" spk-sidebar-toc-wrapper">
          <!-- <div class="btn-group w-100 mb-2" role="group" aria-label="rellinks">
            <a href="#" role="button" class="btn spk-btn-rellink py-1 disabled"">Prev</a>
            <a href="#" role="button" class="btn spk-btn-rellink disabled py-1">Up</a>
            <a href="#" role="button" class="btn spk-btn-rellink py-1 disabled"">Next</a>
          </div>
          <hr> -->
          <div class="spk-sidebar-toc">
            <ul>
<li><a class="reference internal" href="#">ATAR: Automatic and Tunable Artifact Removal Algorithm</a></li>
</ul>

          </div>
      </div>
      <br>
      <br>
      <br>
      <br>
      <br>
    </div>
    <div id="spk-page-content-wrapper">
      <div class="spk-page-content container-fluid body px-md-3" role="main">
        
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-signal-processing-plot-sp-atar-algorithm-eeg-artifact-removal-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code or to run this example in your browser via JupyterLite or Binder</p>
</div>
<section class="sphx-glr-example-title" id="atar-automatic-and-tunable-artifact-removal-algorithm">
<span id="sphx-glr-auto-examples-signal-processing-plot-sp-atar-algorithm-eeg-artifact-removal-py"></span><h1>ATAR: Automatic and Tunable Artifact Removal Algorithm<a class="headerlink" href="#atar-automatic-and-tunable-artifact-removal-algorithm" title="Link to this heading">¶</a></h1>
<p>ATAR: Automatic and Tunable Artifact Removal Algorithm
&lt;div class=”toc”&gt;&lt;ul class=”toc-item”&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#ATAR:-Automatic-and-Tunable-Artifact-Removal-Algorithm” data-toc-modified-id=”ATAR:-Automatic-and-Tunable-Artifact-Removal-Algorithm-1”&gt;&lt;span class=”toc-item-num”&gt;1&amp;nbsp;&amp;nbsp;&lt;/span&gt;ATAR: Automatic and Tunable Artifact Removal Algorithm&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Import-EEG-sample-data” data-toc-modified-id=”Import-EEG-sample-data-2”&gt;&lt;span class=”toc-item-num”&gt;2&amp;nbsp;&amp;nbsp;&lt;/span&gt;Import EEG sample data&lt;/a&gt;&lt;/span&gt;&lt;ul class=”toc-item”&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Filter-with-highpass” data-toc-modified-id=”Filter-with-highpass-2.1”&gt;&lt;span class=”toc-item-num”&gt;2.1&amp;nbsp;&amp;nbsp;&lt;/span&gt;Filter with highpass&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Applying-ATAR-Algorithm” data-toc-modified-id=”Applying-ATAR-Algorithm-3”&gt;&lt;span class=”toc-item-num”&gt;3&amp;nbsp;&amp;nbsp;&lt;/span&gt;Applying ATAR Algorithm&lt;/a&gt;&lt;/span&gt;&lt;ul class=”toc-item”&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Soft-Thresholding:-default-settings:-OptMode=’soft’-and-$beta=0.1$” data-toc-modified-id=”Soft-Thresholding:-default-settings:-OptMode=’soft’-and-$beta=0.1$-3.1”&gt;&lt;span class=”toc-item-num”&gt;3.1&amp;nbsp;&amp;nbsp;&lt;/span&gt;Soft Thresholding: default settings: OptMode=’soft’ and $beta=0.1$&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Linear-Attenuation” data-toc-modified-id=”Linear-Attenuation-3.2”&gt;&lt;span class=”toc-item-num”&gt;3.2&amp;nbsp;&amp;nbsp;&lt;/span&gt;Linear Attenuation&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Elimination” data-toc-modified-id=”Elimination-3.3”&gt;&lt;span class=”toc-item-num”&gt;3.3&amp;nbsp;&amp;nbsp;&lt;/span&gt;Elimination&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Tuning-$beta$-with-‘soft’-:-Controlling-the-aggressiveness” data-toc-modified-id=”Tuning-$beta$-with-‘soft’-:-Controlling-the-aggressiveness-3.4”&gt;&lt;span class=”toc-item-num”&gt;3.4&amp;nbsp;&amp;nbsp;&lt;/span&gt;Tuning $beta$ with ‘soft’ : Controlling the aggressiveness&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Tuning-$beta$-with-‘elim’” data-toc-modified-id=”Tuning-$beta$-with-‘elim’-3.5”&gt;&lt;span class=”toc-item-num”&gt;3.5&amp;nbsp;&amp;nbsp;&lt;/span&gt;Tuning $beta$ with ‘elim’&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Other-settings” data-toc-modified-id=”Other-settings-4”&gt;&lt;span class=”toc-item-num”&gt;4&amp;nbsp;&amp;nbsp;&lt;/span&gt;Other settings&lt;/a&gt;&lt;/span&gt;&lt;ul class=”toc-item”&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Changing-wavelet-function” data-toc-modified-id=”Changing-wavelet-function-4.1”&gt;&lt;span class=”toc-item-num”&gt;4.1&amp;nbsp;&amp;nbsp;&lt;/span&gt;Changing wavelet function&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Changing-upper-and-lower-bounds:-$k_1$,-$k_2$” data-toc-modified-id=”Changing-upper-and-lower-bounds:-$k_1$,-$k_2$-4.2”&gt;&lt;span class=”toc-item-num”&gt;4.2&amp;nbsp;&amp;nbsp;&lt;/span&gt;Changing upper and lower bounds: $k_1$, $k_2$&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Changing-IPR—-Interpercentile-range” data-toc-modified-id=”Changing-IPR—-Interpercentile-range-4.3”&gt;&lt;span class=”toc-item-num”&gt;4.3&amp;nbsp;&amp;nbsp;&lt;/span&gt;Changing IPR -  Interpercentile range&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Using-the-fix-threshold-$theta_alpha=300$,–to-all-the-windows” data-toc-modified-id=”Using-the-fix-threshold-$theta_alpha=300$,–to-all-the-windows-4.4”&gt;&lt;span class=”toc-item-num”&gt;4.4&amp;nbsp;&amp;nbsp;&lt;/span&gt;Using the fix threshold $theta_alpha=300$,  to all the windows&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Changing-window-length-(5-sec)” data-toc-modified-id=”Changing-window-length-(5-sec)-4.5”&gt;&lt;span class=”toc-item-num”&gt;4.5&amp;nbsp;&amp;nbsp;&lt;/span&gt;Changing window length (5 sec)&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href=”#Doc” data-toc-modified-id=”Doc-5”&gt;&lt;span class=”toc-item-num”&gt;5&amp;nbsp;&amp;nbsp;&lt;/span&gt;Doc&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;</p>
<p>ATAR: Automatic and Tunable Artifact Removal Algorithm</p>
<p><strong>ATAR Algorithm -  Automatic and Tunable Artifact Removal Algorithm for EEG Signal.</strong></p>
<p>The algorithm is based on wavelet packet decomposion (WPD), the full description of algorithm can be found here [Automatic and Tunable Artifact Removal Algorithm for EEG](<a class="reference external" href="https://doi.org/10.1016/j.bspc.2019.101624">https://doi.org/10.1016/j.bspc.2019.101624</a>) from the article [1]. Figure 1 shows the the block diagram and operating mode of filtering.</p>
<dl class="simple">
<dt>&lt;div style=”align: left; text-align:center;”&gt;</dt><dd><p>&lt;img src=”<a class="reference external" href="https://raw.githubusercontent.com/spkit/spkit.github.io/master/assets/images/ATAR_BD_FilteringMode_1.png">https://raw.githubusercontent.com/spkit/spkit.github.io/master/assets/images/ATAR_BD_FilteringMode_1.png</a>” width=”800” /&gt;
&lt;div class=”caption”&gt;Fig 1: ATAR Algorithm Block Diagram and Mode of filtering&lt;/div&gt;</p>
</dd>
</dl>
<p>&lt;/div&gt;</p>
<p>The algorithm is applied on the given multichannel signal X (n,nch), window wise and reconstructed with overall add method. The defualt window size is set to 1 sec (128 samples). For each window, the threshold $theta_alpha$ is computed and applied to filter the wavelet coefficients.</p>
<p>There is manily one parameter that can be tuned $beta$ with different operating modes and other settings.
Here is the list of parameters and there simplified meaning given:</p>
<p>Parameters:
* $beta$: This is a main parameter to tune, highher the value, more aggressive the algorithm to remove the artifacts. By default it is set to 0.1. $beta$ is postive float value.</p>
<ul>
<li><p><strong>*OptMode*</strong>: This sets the mode of operation, which decides hoe to remove the artifact. By default it is set to ‘soft’, which means Soft Thresholding, in this mode, rather than removing the pressumed artifact, it is suppressed to the threshold, softly. OptMode=’linAtten’, suppresses the pressumed artifact depending on how far it is from threshold. Finally, the most common mode - Elimination (OptMode=’elim’), which remove the pressumed artifact.</p>
<blockquote>
<div><ul class="simple">
<li><p>Soft Thresholding and Linear Attenuation require addition parameters to set the associated thresholds which are by default set to bf=2, gf=0.8.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>*wv=db3*</strong>: Wavelet funtion, by default set to db3, could be any of [‘db3’…..’db38’, ‘sym2…..sym20’, ‘coif1…..coif17’, ‘bior1.1….bior6.8’, ‘rbio1.1…rbio6.8’, ‘dmey’]</p></li>
<li><p>$k_1$, $k_2$: Lower and upper bounds on threshold $theta_alpha$.</p></li>
<li><p><strong>*IPR=[25,75]*</strong>: interpercentile range, range used to compute threshold</p></li>
</ul>
<p>Figure 2, below, shows the affect of $beta$ on a segment of signal with three different modes.</p>
<dl class="simple">
<dt>&lt;div style=”align: left; text-align:center;”&gt;</dt><dd><p>&lt;img src=”<a class="reference external" href="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/atar_beta_tune.gif">https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/atar_beta_tune.gif</a>” width=”500” /&gt;
&lt;div class=”caption”&gt;Fig 1: ATAR Algorithm with three mode of filtering&lt;/div&gt;</p>
</dd>
</dl>
<p>&lt;/div&gt;</p>
<p><strong>Reference</strong>
* [1] Bajaj, Nikesh, et al. “Automatic and tunable algorithm for EEG artifact removal using wavelet decomposition with applications in predictive modeling during auditory tasks.” Biomedical Signal Processing and Control 55 (2020): 101624.</p>
<p>There are three functions in <strong>spkit.eeg</strong> for <strong>ATAR algorithm</strong></p>
<ul class="simple">
<li><p><strong>spkit.eeg.ATAR(…)</strong></p></li>
<li><p>spkit.eeg.ATAR_1Ch(…)</p></li>
<li><p>spkit.eeg.ATAR_mCh(…)</p></li>
<li><p>spkit.eeg.ATAR_mCh_noParallel(…)</p></li>
</ul>
<p><strong>*spkit.eeg.ATAR_1Ch*</strong> is for single channel input signal x of shape (n,), where as, <strong>*spkit.eeg.ATAR_mCh*</strong> is for multichannel signal X with shape (n,ch), which uses joblib for parallel processing of multi channels. For some OS, joblib raise an error of <strong>*BrokenProcessPool*</strong>, in that case use  <strong>*spkit.eeg.ATAR_mCh_noParallel*</strong>, which is same as <strong>*spkit.eeg.ATAR_mCh*</strong>, except parallel processing. Alternatively, use <strong>*spkit.eeg.ATAR_1Ch*</strong> with for loop for each channel.</p>
<p><strong>*spkit.eeg.ATAR*</strong> is generalized function, this will call <strong>*spkit.eeg.ATAR_1Ch*</strong> is single channel is passed else <strong>*spkit.eeg.ATAR_mCh*</strong> and with <em>use_joblib</em> agrument, it can be set to try parallel processing, else will process each channel individually. We recommed to use <strong>*spkit.eeg.ATAR*</strong>.</p>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_001.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_001.png" alt="Xf: 14 channel - EEG Signal (filtered)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_002.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_002.png" alt="XR: Corrected Signal" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_003.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_003.png" alt="Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_004.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_004.png" alt="XR: Corrected Signal" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_005.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_005.png" alt="Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_006.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_006.png" alt="XR: Corrected Signal" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_007.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_007.png" alt="Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_008.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_008.png" alt="XR: Corrected Signal: $\beta=$0.01, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_009.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_009.png" alt="XR: Corrected Signal: $\beta=$0.03, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_010.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_010.png" alt="XR: Corrected Signal: $\beta=$0.05, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_011.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_011.png" alt="XR: Corrected Signal: $\beta=$0.07, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_012.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_012.png" alt="XR: Corrected Signal: $\beta=$0.09, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_013.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_013.png" alt="XR: Corrected Signal: $\beta=$0.1, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_014.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_014.png" alt="XR: Corrected Signal: $\beta=$0.2, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_015.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_015.png" alt="XR: Corrected Signal: $\beta=$0.3, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_016.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_016.png" alt="XR: Corrected Signal: $\beta=$0.4, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_017.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_017.png" alt="XR: Corrected Signal: $\beta=$0.5, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_018.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_018.png" alt="XR: Corrected Signal: $\beta=$0.6, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_019.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_019.png" alt="XR: Corrected Signal: $\beta=$0.7, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_020.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_020.png" alt="XR: Corrected Signal: $\beta=$0.8, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_021.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_021.png" alt="XR: Corrected Signal: $\beta=$0.9, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_022.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_022.png" alt="XR: Corrected Signal: $\beta=$0.01, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_023.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_023.png" alt="XR: Corrected Signal: $\beta=$0.03, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_024.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_024.png" alt="XR: Corrected Signal: $\beta=$0.05, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_025.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_025.png" alt="XR: Corrected Signal: $\beta=$0.07, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_026.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_026.png" alt="XR: Corrected Signal: $\beta=$0.09, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_027.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_027.png" alt="XR: Corrected Signal: $\beta=$0.1, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_028.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_028.png" alt="XR: Corrected Signal: $\beta=$0.2, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_029.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_029.png" alt="XR: Corrected Signal: $\beta=$0.3, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_030.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_030.png" alt="XR: Corrected Signal: $\beta=$0.4, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_031.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_031.png" alt="XR: Corrected Signal: $\beta=$0.5, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_032.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_032.png" alt="XR: Corrected Signal: $\beta=$0.6, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_033.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_033.png" alt="XR: Corrected Signal: $\beta=$0.7, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_034.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_034.png" alt="XR: Corrected Signal: $\beta=$0.8, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_035.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_035.png" alt="XR: Corrected Signal: $\beta=$0.9, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_036.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_036.png" alt="XR: Corrected Signal: $wv=db8$, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_037.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_037.png" alt="XR: Corrected Signal: $wv=db32$, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_038.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_038.png" alt="XR: Corrected Signal: $k_2=200$, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_039.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_039.png" alt="XR: Corrected Signal: $IPR=[15,85]$~ 70%, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_040.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_040.png" alt="XR: Corrected Signal: $\theta_\alpha=300$, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_041.png" srcset="../../_images/sphx_glr_plot_sp_ATAR_algorithm_eeg_artifact_removal_041.png" alt="XR: Corrected Signal: $winsize=5sec$, Xf - XR: Difference (removed signal)" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/Users/nikeshbajaj/Library/CloudStorage/OneDrive-QueenMary,UniversityofLondon/Github/GIT3/Dev/SPKIT_Dev/SPKIT_DOC_7/examples/signal_processing/plot_sp_ATAR_algorithm_eeg_artifact_removal.py:79: DeprecationWarning: function eegSample will be deprecated in future version, due to naming convension, please use &#39;eeg_sample_14ch&#39; for updated/improved functionality [spkit-0.0.9.7].
/Users/nikeshbajaj/anaconda3/envs/SPHX/lib/python3.10/site-packages/scipy/signal/_filter_design.py:2899: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
Help on function ATAR in module spkit.eeg.atar_algorithm:

ATAR(X, wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;, OptMode=&#39;soft&#39;, IPR=[25, 75], beta=0.1, k1=10, k2=100, est_wmax=100, theta_a=inf, bf=2, gf=0.8, wpd_mode=&#39;symmetric&#39;, wpd_maxlevel=None, recons_method=&#39;atar-style&#39;, window=[&#39;hamming&#39;, True], hopesize=None, packetwise=False, WPD=True, lvl=[], use_joblib=False, verbose=False, **kwargs)
    ATAR - Automatic and Tunable Artifact Removal Algorithm

    .. raw:: html

        &lt;h2 style=&quot;text-align:center&quot;&gt;ATAR: - Automatic and Tunable Artifact Removal Algorithm&lt;/h2&gt;

    Apply ATAR on short windows of signal (single channel):

    Signal is decomposed in smaller overlapping windows and reconstructed after correcting using overlap-add method.

    For more details, check [1]_

    **Operating Modes**

    **1. Soft Thresholding**

    .. math ::

       \lambda_s (w)  &amp;=  w  &amp; \quad \text{if } |w|&lt;\theta_{\gamma}

          &amp;=  \theta_{\alpha} \frac{1 - e^{\alpha w}}{1 + e^{\alpha w}}   &amp; \quad \text{otherwise}


    **2. Elimination**

    .. math ::

       \lambda_e (w)  &amp;=  w  &amp; \quad \text{if } |w| \le \theta_{\alpha}

         &amp;=  0   &amp; \quad \text{otherwise}


    **3. Linear Attenuation**

    .. math ::

       \lambda_a (w)  &amp;=  w  &amp; \quad \text{if } |w| \le \theta_{\alpha}

              &amp;=  sgn(w) \theta_{\alpha} \Big( 1 -  \frac{|w| - \theta_{\alpha}}{\theta_{\beta}-\theta_{\alpha}} \Big) &amp; \quad \text{if } \theta_{\alpha} &lt; |w| \le \theta_{\beta}

              &amp;=  0   &amp; \quad \text{otherwise}


    **Computing Threshold**

    * :math:`f_{\beta}(r)  = k_2 \cdot exp \Big(-\beta \frac{w_{max}}{k_2} \times \frac{r}{2} \Big)`

    * :math:`\theta_{\alpha}  =  f_{\beta}(r)  \quad \text{if } f_{\beta}(r) \ge k_1` otherwise :math:`\theta_{\alpha}  =  k_1`

    * :math:`\theta_{\gamma}  = g_f \times \theta_{\alpha}` ,  where a default value for &#39;g_f = 0.8&#39; **For Soft-threshold**

    * :math:`\theta_{\beta}  = b_f \times \theta_{\alpha}` , where a default value for &#39;b_f = 2&#39; **For Linear Attenuation**


    Parameters
    ----------
    x : 1d-array
      - input single-channel signal of shape (n,)

    wv = str, &#39;db3&#39;(default) wavelet
      - one of wavelet family {&#39;db3&#39;.....&#39;db38&#39;, &#39;sym2.....sym20&#39;,
                     &#39;coif1.....coif17&#39;, &#39;bior1.1....bior6.8&#39;,
                    &#39;rbio1.1...rbio6.8&#39;, &#39;dmey&#39;}

    winsize: int, deafult=128
       -  window size to apply ATAR

    hopesize: int, None, default=None,
       - overlap shift for next window
       - if None, hopesize=winsize//2
       - only used when recons_method={&#39;atar-style&#39;,&#39;atar&#39;,&#39;custom&#39;}


    Operating modes

    OptMode: str, {&#39;soft&#39;,&#39;elim&#39;,&#39;linAtten&#39;}, default &#39;soft&#39;
        - Operating Modes:
        - soft: soft-thresholding (need theta_a, and theta_g)
        - elim: Elimination mode  (need theta_a)
        - linAtten: Linear Attenuation mode (need theta_a and theta_b)
            - given `bf` and `gf` (default bf = 2, gf=0.8)
            -  where:-
                * theta_b = bf*theta_a  -- used for Linear Attenuation
                * theta_g = gf*theta_a  -- used for Soft thresholding

    *Threshold Computation method*

    thr_method: str, {&#39;ipr&#39;, None}
        - Computing method for threshold
        - if &#39;ipr&#39;  &#39;theta_a&#39; is computed as per ATAR&#39;s approach
        - if None, passed value of &#39;theta_a&#39; is used along with (bf, gf)

    IPR: list of two default=[25,75]
       - To compute Interpercentile range r
       - e.g. [10,90], [30,70]
       - Higher the range is, threshold is more affected by outliers
       - Interpercentile range r is mapped to threshold, using `beta`, `k1` and `k2`

    beta: float (0,1] default=0.1
       - beta as tuning parameter for threshold
       - higher the value, more aggressive is the algorithm to remove artifacts

    (k1,k2) :scalars, defualt (10,100)
       - lower and upper bounds on the threshold value
       - should be of same order as signal magnitude.
       - if signal is in volts, values will be of order 1e-6, then k1 and k2 should be around those order
       - defult values k1=10, k2=100 are chosen for signal with unit of microVolt (uV), of order of 100s


       .. warning:: k1,k2 bounds
          if k2 is very high (e.g. 100) and signal amplitude is in 1e-3, 1e-6,
          ATAR will have no effect on the signal, as theshold to identify and remove artifacts will be so high.


    est_wmax: int, default=100
        - est_wmax is the value in the expression (15 in paper) or above Computing Threshold equations `w_max`


    *Wavelet Decomposition*

    wpd_mode: str,  default &#39;symmetric&#39;
        -  one of the {&#39;zero&#39;, &#39;constant&#39;, &#39;symmetric&#39;, &#39;periodic&#39;,
            &#39;smooth&#39;, &#39;periodization&#39;}

    wpd_maxlevel: int, defualt=None
        - maximum number of levels for decomposition,
        - if None, max possible number of level are used.

    use_joblib: bool, default=False
        -  If True, joblib is used for parallel processing of the channels

    verbose: int
       -  vebosity level


    Experimental Settings

        .. note:: NOT RECOMMONEDED TO CHANGE
            Following parameters are experimental,
            they are not recommonded to change, and leave as default

    WPD: bool, default=True
       - if False Wavelet Transform is used for decompisiton of signal,
         else Wavelet Packet Decomposition is used

    packetwise: bool, deafult=False
       -  if True, threshold is computed and applied to each packet independently.

    lvl: list defualt=[]
       -  if provided, ATAR is applied to provided level numbers only.

    recons_method: str deafult=&#39;atar-style&#39;
       - reconstruction method after applying atar to each window.
       - one of {&#39;atar-style&#39;, &#39;atar&#39;, &#39;custom&#39;, &#39;HamWin&#39;,&#39;Hamming&#39;}

       .. note:: NOT RECOMMONEDED TO CHANGE
          KEEP IT TO DEFAULT


    window: list of two default=[&#39;hamming&#39;,True]
        -  window function, and if windowing is applied before or after atar


    Returns
    -------
    XR: corrected signal of same shape as input X


    References
    ----------
    .. [1] Bajaj, Nikesh, et al. &quot;Automatic and tunable algorithm for EEG artifact removal using wavelet decomposition with applications in predictive modeling during auditory tasks.&quot; Biomedical Signal Processing and Control 55 (2020): 101624. https://doi.org/10.1016/j.bspc.2019.101624




    See Also
    --------
    ATAR_1Ch: ATAR for single channel
    ATAR_mCh: ATAR for multiple channel
    ICA_filtering: ICA based Artifact Removal Algorithm


    Examples
    --------
    #sp.eeg.ATAR
    import numpy as np
    import matplotlib.pyplot as plt
    import spkit as sp
    X,fs, ch_names = sp.data.eeg_sample_14ch()
    X = sp.filterDC_sGolay(X, window_length=fs//3+1)
    t = np.arange(X.shape[0])/fs
    # Single Channel
    x = X[:,0]
    xc1 = sp.eeg.ATAR(x,wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;,beta=0.1, k1=10, k2=100,OptMode=&#39;soft&#39;,verbose=1)
    xc2 = sp.eeg.ATAR(x,wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;,beta=0.1, k1=10, k2=100,OptMode=&#39;linAtten&#39;,verbose=1)
    xc3 = sp.eeg.ATAR(x,wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;,beta=0.1, k1=10, k2=100,OptMode=&#39;elim&#39;,verbose=1)
    # Multi-Channel
    Xc = sp.eeg.ATAR(X,wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;,beta=0.2, k1=10, k2=100,OptMode=&#39;elim&#39;)
    sep=200
    plt.figure(figsize=(10,6))
    plt.subplot(211)
    plt.plot(t,x, label=&#39;$x$: raw EEG - single channel&#39;)
    plt.plot(t,xc1,label=r&#39;$x_{c1}$: Soft Thresholding&#39;)
    plt.plot(t,xc2,label=r&#39;$x_{c2}$: Linear Attenuation&#39;)
    plt.plot(t,xc3,label=r&#39;$x_{c3}$: Elimination&#39;)
    plt.xlim([9,12])
    plt.ylim([-200,200])
    plt.legend(bbox_to_anchor=(0.5,0.99),ncol=2,fontsize=8)
    plt.grid()
    plt.title(r&#39;ATAR Algorithm&#39;)
    plt.xlabel(&#39;time (s)&#39;)
    plt.subplot(223)
    plt.plot(t,X+np.arange(X.shape[1])*sep)
    plt.xlim([t[0],t[-1]])
    plt.yticks(np.arange(X.shape[1])*sep,ch_names)
    plt.title(r&#39;$X$: EEG&#39;)
    plt.xlabel(&#39;time (s)&#39;)
    plt.subplot(224)
    plt.plot(t,Xc+np.arange(14)*sep)
    plt.xlim([t[0],t[-1]])
    plt.title(r&#39;$X_c$: ATAR (Elimination Mode)&#39;)
    plt.yticks(np.arange(X.shape[1])*sep,ch_names)
    plt.xlabel(&#39;time (s)&#39;)
    plt.tight_layout()
    plt.show()

Help on function ATAR_1Ch in module spkit.eeg.atar_algorithm:

ATAR_1Ch(x, wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;, OptMode=&#39;soft&#39;, IPR=[25, 75], beta=0.1, k1=None, k2=100, est_wmax=100, theta_a=inf, bf=2, gf=0.8, wpd_mode=&#39;symmetric&#39;, wpd_maxlevel=None, recons_method=&#39;atar-style&#39;, window=[&#39;hamming&#39;, True], hopesize=None, packetwise=False, WPD=True, lvl=[], verbose=False, **kwargs)
    ATAR : Automatic and Tunable Artifact Removal Algorithm (single channel)

    .. raw:: html

        &lt;h2 style=&quot;text-align:center&quot;&gt;ATAR: - Automatic and Tunable Artifact Removal Algorithm :  Single Channel&lt;/h2&gt;

    Apply ATAR on short windows of signal (single channel):

    Signal is decomposed in smaller overlapping windows and reconstructed after correcting using overlap-add method.

    For more details, check [1]_

    **Operating Modes**

    **1. Soft Thresholding**

    .. math ::

       \lambda_s (w)  &amp;=  w  &amp; \quad \text{if } |w|&lt;\theta_{\gamma}

          &amp;=  \theta_{\alpha} \frac{1 - e^{\alpha w}}{1 + e^{\alpha w}}   &amp; \quad \text{otherwise}


    **2. Elimination**

    .. math ::

       \lambda_e (w)  &amp;=  w  &amp; \quad \text{if } |w| \le \theta_{\alpha}

         &amp;=  0   &amp; \quad \text{otherwise}


    **3. Linear Attenuation**

    .. math ::

       \lambda_a (w)  &amp;=  w  &amp; \quad \text{if } |w| \le \theta_{\alpha}

              &amp;=  sgn(w) \theta_{\alpha} \Big( 1 -  \frac{|w| - \theta_{\alpha}}{\theta_{\beta}-\theta_{\alpha}} \Big) &amp; \quad \text{if } \theta_{\alpha} &lt; |w| \le \theta_{\beta}

              &amp;=  0   &amp; \quad \text{otherwise}


    **Computing Threshold**

    * :math:`f_{\beta}(r)  = k_2 \cdot exp \Big(-\beta \frac{w_{max}}{k_2} \times \frac{r}{2} \Big)`

    * :math:`\theta_{\alpha}  =  f_{\beta}(r)  \quad \text{if } f_{\beta}(r) \ge k_1` otherwise :math:`\theta_{\alpha}  =  k_1`

    * :math:`\theta_{\gamma}  = g_f \times \theta_{\alpha}` ,  where a default value for &#39;g_f = 0.8&#39; **For Soft-threshold**

    * :math:`\theta_{\beta}  = b_f \times \theta_{\alpha}` , where a default value for &#39;b_f = 2&#39; **For Linear Attenuation**




    ..
        _wfilter(x,wv=&#39;db3&#39;,thr_method=&#39;ipr&#39;,IPR=[25,75],beta=0.1,k1=10,k2=100,theta_a=np.inf,est_wmax=100,
            bf=2,gf=0.8,OptMode =&#39;soft&#39;,factor=1.0,show_plot=False,wpd_mode=&#39;symmetric&#39;,wpd_maxlevel=None,
            WPD=True,packetwise=False,lvl=[],fs=128.0,verbose=0)

    Parameters
    ----------
    x : 1d-array
      - input single-channel signal of shape (n,)

    wv = str, &#39;db3&#39;(default) wavelet
      - one of wavelet family {&#39;db3&#39;.....&#39;db38&#39;, &#39;sym2.....sym20&#39;,
                     &#39;coif1.....coif17&#39;, &#39;bior1.1....bior6.8&#39;,
                    &#39;rbio1.1...rbio6.8&#39;, &#39;dmey&#39;}

    winsize: int, deafult=128
       -  window size to apply ATAR

    hopesize: int, None, default=None,
       - overlap shift for next window
       - if None, hopesize=winsize//2
       - only used when recons_method={&#39;atar-style&#39;,&#39;atar&#39;,&#39;custom&#39;}


    Operating modes

    OptMode: str, {&#39;soft&#39;,&#39;elim&#39;,&#39;linAtten&#39;}, default &#39;soft&#39;
        - Operating Modes:
        - soft: soft-thresholding (need theta_a, and theta_g)
        - elim: Elimination mode  (need theta_a)
        - linAtten: Linear Attenuation mode (need theta_a and theta_b)
            - given `bf` and `gf` (default bf = 2, gf=0.8)
            -  where:-
                * theta_b = bf*theta_a  -- used for Linear Attenuation
                * theta_g = gf*theta_a  -- used for Soft thresholding

    *Threshold Computation method*

    thr_method: str, {&#39;ipr&#39;, None}
        - Computing method for threshold
        - if &#39;ipr&#39;  &#39;theta_a&#39; is computed as per ATAR&#39;s approach
        - if None, passed value of &#39;theta_a&#39; is used along with (bf, gf)

    IPR: list of two default=[25,75]
       - To compute Interpercentile range r
       - e.g. [10,90], [30,70]
       - Higher the range is, threshold is more affected by outliers
       - Interpercentile range r is mapped to threshold, using `beta`, `k1` and `k2`

    beta: float (0,1] default=0.1
       - beta as tuning parameter for threshold
       - higher the value, more aggressive is the algorithm to remove artifacts

    (k1,k2) :scalars, defualt (10,100)
       - lower and upper bounds on the threshold value
       - should be of same order as signal magnitude.
       - if signal is in volts, values will be of order 1e-6, then k1 and k2 should be around those order
       - defult values k1=10, k2=100 are chosen for signal with unit of microVolt (uV), of order of 100s


       .. warning:: k1,k2 bounds
          if k2 is very high (e.g. 100) and signal amplitude is in 1e-3, 1e-6,
          ATAR will have no effect on the signal, as theshold to identify and remove artifacts will be so high.


    est_wmax: int, default=100
        - est_wmax is the value in the expression (15 in paper) or above Computing Threshold equations `w_max`


    *Wavelet Decomposition*

    wpd_mode: str,  default &#39;symmetric&#39;
        -  one of the {&#39;zero&#39;, &#39;constant&#39;, &#39;symmetric&#39;, &#39;periodic&#39;,
            &#39;smooth&#39;, &#39;periodization&#39;}

    wpd_maxlevel: int, defualt=None
        - maximum number of levels for decomposition,
        - if None, max possible number of level are used.

    verbose: int
       - verbosity mode

    Experimental Settings

        .. note:: NOT RECOMMONEDED TO CHANGE
            Following parameters are experimental,
            they are not recommonded to change, and leave as default

    WPD: bool, default=True
       - if False Wavelet Transform is used for decompisiton of signal,
         else Wavelet Packet Decomposition is used

    packetwise: bool, deafult=False
       -  if True, threshold is computed and applied to each packet independently.

    lvl: list defualt=[]
       -  if provided, ATAR is applied to provided level numbers only.

    recons_method: str deafult=&#39;atar-style&#39;
       - reconstruction method after applying atar to each window.
       - one of {&#39;atar-style&#39;, &#39;atar&#39;, &#39;custom&#39;, &#39;HamWin&#39;,&#39;Hamming&#39;}

       .. note:: NOT RECOMMONEDED TO CHANGE
          KEEP IT TO DEFAULT


    window: list of two default=[&#39;hamming&#39;,True]
        -  window function, and if windowing is applied before or after atar



    Returns
    -------
    XR: corrected signal of same shape as input X

    Reference
    ---------
    .. [1] Bajaj, Nikesh, et al. &quot;Automatic and tunable algorithm for EEG artifact removal using wavelet decomposition with applications in predictive modeling during auditory tasks.&quot; Biomedical Signal Processing and Control 55 (2020): 101624. https://doi.org/10.1016/j.bspc.2019.101624


    See Also
    --------
    ATAR: Automatic and Tuanable Artifact Removal Algorithm
    ATAR_mCh: ATAR for multiple channel
    ICA_filtering: ICA based Artifact Removal Algorithm


    Examples
    --------
    #sp.eeg.ATAR_1Ch
    import numpy as np
    import matplotlib.pyplot as plt
    import spkit as sp
    X,fs, ch_names = sp.data.eeg_sample_14ch()
    X = sp.filterDC_sGolay(X, window_length=fs//3+1)
    t = np.arange(X.shape[0])/fs
    # Single Channel
    x = X[:,0]
    xc1 = sp.eeg.ATAR_1Ch(x,wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;,beta=0.1, k1=10, k2=100,OptMode=&#39;soft&#39;,verbose=1)
    xc2 = sp.eeg.ATAR_1Ch(x,wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;,beta=0.1, k1=10, k2=100,OptMode=&#39;linAtten&#39;,verbose=1)
    xc3 = sp.eeg.ATAR_1Ch(x,wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;,beta=0.1, k1=10, k2=100,OptMode=&#39;elim&#39;,verbose=1)
    plt.figure(figsize=(10,6))
    plt.subplot(211)
    plt.plot(t,x, label=&#39;$x$: raw EEG - single channel&#39;)
    plt.plot(t,xc1,label=r&#39;$x_{c1}$: Soft Thresholding&#39;)
    plt.plot(t,xc2,label=r&#39;$x_{c2}$: Linear Attenuation&#39;)
    plt.plot(t,xc3,label=r&#39;$x_{c3}$: Elimination&#39;)
    #plt.xlim([9,12])
    #plt.ylim([-200,200])
    plt.legend(bbox_to_anchor=(0.5,0.99),ncol=2,fontsize=8)
    plt.grid()
    plt.title(r&#39;ATAR Algorithm&#39;)
    plt.subplot(212)
    plt.plot(t,x, label=&#39;$x$: raw EEG - single channel&#39;)
    plt.plot(t,xc1,label=r&#39;$x_{c1}$: Soft Thresholding&#39;)
    plt.plot(t,xc2,label=r&#39;$x_{c2}$: Linear Attenuation&#39;)
    plt.plot(t,xc3,label=r&#39;$x_{c3}$: Elimination&#39;)
    plt.xlim([9,12])
    plt.ylim([-200,200])
    plt.legend(bbox_to_anchor=(0.5,0.99),ncol=2,fontsize=8)
    plt.grid()
    plt.title(r&#39;ATAR Algorithm&#39;)
    plt.xlabel(&#39;time (s)&#39;)
    plt.tight_layout()
    plt.show()

Help on function ATAR_mCh in module spkit.eeg.atar_algorithm:

ATAR_mCh(X, wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;, OptMode=&#39;elim&#39;, IPR=[25, 75], beta=0.1, k1=10, k2=100, est_wmax=100, theta_a=inf, bf=2, gf=0.8, wpd_mode=&#39;symmetric&#39;, wpd_maxlevel=None, verbose=False, window=[&#39;hamming&#39;, True], hopesize=None, recons_method=&#39;atar-style&#39;, packetwise=False, WPD=True, lvl=[], use_joblib=False, **kwargs)
    ATAR: - Automatic and Tunable Artifact Removal Algorithm

    .. raw:: html

        &lt;h2 style=&quot;text-align:center&quot;&gt;ATAR: - Automatic and Tunable Artifact Removal Algorithm: Multi-channels&lt;/h2&gt;

    Apply ATAR on short windows of signal

    Signal is decomposed in smaller overlapping windows and reconstructed after correcting using overlap-add method.

    For more details, check [1]_

    **Operating Modes**

    **1. Soft Thresholding**

    .. math ::

       \lambda_s (w)  &amp;=  w  &amp; \quad \text{if } |w|&lt;\theta_{\gamma}

          &amp;=  \theta_{\alpha} \frac{1 - e^{\alpha w}}{1 + e^{\alpha w}}   &amp; \quad \text{otherwise}


    **2. Elimination**

    .. math ::

       \lambda_e (w)  &amp;=  w  &amp; \quad \text{if } |w| \le \theta_{\alpha}

         &amp;=  0   &amp; \quad \text{otherwise}


    **3. Linear Attenuation**

    .. math ::

       \lambda_a (w)  &amp;=  w  &amp; \quad \text{if } |w| \le \theta_{\alpha}

              &amp;=  sgn(w) \theta_{\alpha} \Big( 1 -  \frac{|w| - \theta_{\alpha}}{\theta_{\beta}-\theta_{\alpha}} \Big) &amp; \quad \text{if } \theta_{\alpha} &lt; |w| \le \theta_{\beta}

              &amp;=  0   &amp; \quad \text{otherwise}


    **Computing Threshold**

    * :math:`f_{\beta}(r)  = k_2 \cdot exp \Big(-\beta \frac{w_{max}}{k_2} \times \frac{r}{2} \Big)`

    * :math:`\theta_{\alpha}  =  f_{\beta}(r)  \quad \text{if } f_{\beta}(r) \ge k_1` otherwise :math:`\theta_{\alpha}  =  k_1`

    * :math:`\theta_{\gamma}  = g_f \times \theta_{\alpha}` ,  where a default value for &#39;g_f = 0.8&#39; **For Soft-threshold**

    * :math:`\theta_{\beta}  = b_f \times \theta_{\alpha}` , where a default value for &#39;b_f = 2&#39; **For Linear Attenuation**


    Parameters
    ----------
    x : 1d-array
      - input single-channel signal of shape (n,)

    wv = str, &#39;db3&#39;(default) wavelet
      - one of wavelet family {&#39;db3&#39;.....&#39;db38&#39;, &#39;sym2.....sym20&#39;,
                     &#39;coif1.....coif17&#39;, &#39;bior1.1....bior6.8&#39;,
                    &#39;rbio1.1...rbio6.8&#39;, &#39;dmey&#39;}

    winsize: int, deafult=128
       -  window size to apply ATAR

    hopesize: int, None, default=None,
       - overlap shift for next window
       - if None, hopesize=winsize//2
       - only used when recons_method={&#39;atar-style&#39;,&#39;atar&#39;,&#39;custom&#39;}


    Operating modes

    OptMode: str, {&#39;soft&#39;,&#39;elim&#39;,&#39;linAtten&#39;}, default &#39;soft&#39;
        - Operating Modes:
        - soft: soft-thresholding (need theta_a, and theta_g)
        - elim: Elimination mode  (need theta_a)
        - linAtten: Linear Attenuation mode (need theta_a and theta_b)
            - given `bf` and `gf` (default bf = 2, gf=0.8)
            -  where:-
                * theta_b = bf*theta_a  -- used for Linear Attenuation
                * theta_g = gf*theta_a  -- used for Soft thresholding

    *Threshold Computation method*

    thr_method: str, {&#39;ipr&#39;, None}
        - Computing method for threshold
        - if &#39;ipr&#39;  &#39;theta_a&#39; is computed as per ATAR&#39;s approach
        - if None, passed value of &#39;theta_a&#39; is used along with (bf, gf)

    IPR: list of two default=[25,75]
       - To compute Interpercentile range r
       - e.g. [10,90], [30,70]
       - Higher the range is, threshold is more affected by outliers
       - Interpercentile range r is mapped to threshold, using `beta`, `k1` and `k2`

    beta: float (0,1] default=0.1
       - beta as tuning parameter for threshold
       - higher the value, more aggressive is the algorithm to remove artifacts

    (k1,k2) :scalars, defualt (10,100)
       - lower and upper bounds on the threshold value
       - should be of same order as signal magnitude.
       - if signal is in volts, values will be of order 1e-6, then k1 and k2 should be around those order
       - defult values k1=10, k2=100 are chosen for signal with unit of microVolt (uV), of order of 100s


       .. warning:: k1,k2 bounds
          if k2 is very high (e.g. 100) and signal amplitude is in 1e-3, 1e-6,
          ATAR will have no effect on the signal, as theshold to identify and remove artifacts will be so high.


    est_wmax: int, default=100
        - est_wmax is the value in the expression (15 in paper) or above Computing Threshold equations `w_max`


    *Wavelet Decomposition*

    wpd_mode: str,  default &#39;symmetric&#39;
        -  one of the {&#39;zero&#39;, &#39;constant&#39;, &#39;symmetric&#39;, &#39;periodic&#39;,
            &#39;smooth&#39;, &#39;periodization&#39;}

    wpd_maxlevel: int, defualt=None
        - maximum number of levels for decomposition,
        - if None, max possible number of level are used.

    use_joblib: bool, default=False
        -  If True, joblib is used for parallel processing of the channels

    verbose: int
       - verbosity mode

    Experimental Settings

        .. note:: NOT RECOMMONEDED TO CHANGE
            Following parameters are experimental,
            they are not recommonded to change, and leave as default

    WPD: bool, default=True
       - if False Wavelet Transform is used for decompisiton of signal,
         else Wavelet Packet Decomposition is used

    packetwise: bool, deafult=False
       -  if True, threshold is computed and applied to each packet independently.

    lvl: list defualt=[]
       -  if provided, ATAR is applied to provided level numbers only.

    recons_method: str deafult=&#39;atar-style&#39;
       - reconstruction method after applying atar to each window.
       - one of {&#39;atar-style&#39;, &#39;atar&#39;, &#39;custom&#39;, &#39;HamWin&#39;,&#39;Hamming&#39;}

       .. note:: NOT RECOMMONEDED TO CHANGE
          KEEP IT TO DEFAULT


    window: list of two default=[&#39;hamming&#39;,True]
        -  window function, and if windowing is applied before or after atar

    Returns
    -------
    XR: corrected signal of same shape as input X


    References
    ----------
    .. [1] Bajaj, Nikesh, et al. &quot;Automatic and tunable algorithm for EEG artifact removal using wavelet decomposition with applications in predictive modeling during auditory tasks.&quot; Biomedical Signal Processing and Control 55 (2020): 101624. https://doi.org/10.1016/j.bspc.2019.101624



    See Also
    --------
    ATAR: Automatic and Tuanable Artifact Removal Algorithm
    ATAR_1Ch: ATAR for single channel
    ICA_filtering: ICA based Artifact Removal Algorithm

    Examples
    --------
    #sp.eeg.ATAR_mCh
    import numpy as np
    import matplotlib.pyplot as plt
    import spkit as sp
    X,fs, ch_names = sp.data.eeg_sample_14ch()
    X = sp.filterDC_sGolay(X, window_length=fs//3+1)
    t = np.arange(X.shape[0])/fs
    # Multi-Channel
    Xc = sp.eeg.ATAR_mCh(X,wv=&#39;db3&#39;, winsize=128, thr_method=&#39;ipr&#39;,beta=0.2, k1=10, k2=100,OptMode=&#39;elim&#39;,verbose=1)
    sep=200
    plt.figure(figsize=(10,6))
    plt.subplot(211)
    plt.plot(t,x, label=&#39;$x$: raw EEG - single channel&#39;)
    plt.plot(t,xc1,label=r&#39;$x_{c1}$: Soft Thresholding&#39;)
    plt.plot(t,xc2,label=r&#39;$x_{c2}$: Linear Attenuation&#39;)
    plt.plot(t,xc3,label=r&#39;$x_{c3}$: Elimination&#39;)
    plt.xlim([9,12])
    plt.ylim([-200,200])
    plt.legend(bbox_to_anchor=(0.5,0.99),ncol=2,fontsize=8)
    plt.grid()
    plt.title(r&#39;ATAR Algorithm&#39;)
    plt.xlabel(&#39;time (s)&#39;)
    plt.subplot(223)
    plt.plot(t,X+np.arange(X.shape[1])*sep)
    plt.xlim([t[0],t[-1]])
    plt.yticks(np.arange(X.shape[1])*sep,ch_names)
    plt.title(r&#39;$X$: EEG&#39;)
    plt.xlabel(&#39;time (s)&#39;)
    plt.subplot(224)
    plt.plot(t,Xc+np.arange(14)*sep)
    plt.xlim([t[0],t[-1]])
    plt.title(r&#39;$X_c$: ATAR (Elimination Mode)&#39;)
    plt.yticks(np.arange(X.shape[1])*sep,ch_names)
    plt.xlabel(&#39;time (s)&#39;)
    plt.tight_layout()
    plt.show()
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In[2]:</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<a href="https://docs.python.org/3/library/warnings.html#warnings.filterwarnings" title="warnings.filterwarnings" class="sphx-glr-backref-module-warnings sphx-glr-backref-type-py-function"><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span></a><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">sp</span><span class="o">.</span><span class="n">__version__</span>


<span class="c1"># # Import EEG sample data</span>

<span class="c1"># In[3]:</span>


<span class="n">X</span><span class="p">,</span><span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">load_data</span><span class="o">.</span><span class="n">eegSample</span><span class="p">()</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">128</span>


<span class="c1"># In[4]:</span>


<span class="c1">#help(sp.filter_X)</span>


<span class="c1"># ## Filter with highpass</span>

<span class="c1"># In[5]:</span>


<span class="n">Xf</span> <span class="o">=</span> <a href="../../modules/generated/spkit.filter_X.html#spkit.filter_X" title="spkit.filter_X" class="sphx-glr-backref-module-spkit sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">filter_X</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">band</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;highpass&#39;</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Xf</span><span class="o">.</span><span class="n">shape</span>


<span class="c1"># In[6]:</span>


<span class="n">t</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">fs</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Xf</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf: 14 channel - EEG Signal (filtered)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># # Applying ATAR Algorithm</span>

<span class="c1"># ## Soft Thresholding: default settings: OptMode=&#39;soft&#39; and $\beta=0.1$</span>

<span class="c1"># In[18]:</span>


<span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">XR</span><span class="o">.</span><span class="n">shape</span>


<span class="c1"># In[19]:</span>


<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># ## Linear Attenuation</span>

<span class="c1"># In[20]:</span>


<span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;linAtten&#39;</span><span class="p">)</span>
<span class="n">XR</span><span class="o">.</span><span class="n">shape</span>


<span class="c1"># In[21]:</span>


<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># ## Elimination</span>

<span class="c1"># In[22]:</span>


<span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;elim&#39;</span><span class="p">)</span>
<span class="n">XR</span><span class="o">.</span><span class="n">shape</span>


<span class="c1"># In[23]:</span>


<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># ## Tuning $\beta$ with &#39;soft&#39; : Controlling the aggressiveness</span>

<span class="c1"># In[24]:</span>


<span class="n">betas</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.02</span><span class="p">),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">betas</span><span class="p">:</span>
    <span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">)</span>
    <span class="n">XR</span><span class="o">.</span><span class="n">shape</span>

    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal: &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$\beta=$&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># ## Tuning $\beta$ with &#39;elim&#39;</span>

<span class="c1"># In[25]:</span>


<span class="n">betas</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.02</span><span class="p">),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">betas</span><span class="p">:</span>
    <span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;elim&#39;</span><span class="p">)</span>
    <span class="n">XR</span><span class="o">.</span><span class="n">shape</span>

    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal: &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$\beta=$&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># # Other settings</span>
<span class="c1"># ## Changing wavelet function</span>

<span class="c1"># In[26]:</span>


<span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">wv</span><span class="o">=</span><span class="s1">&#39;db8&#39;</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;elim&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>
<span class="n">XR</span><span class="o">.</span><span class="n">shape</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal: &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$wv=db8$&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="n">XR</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR_mCh_noParallel</span><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">wv</span><span class="o">=</span><span class="s1">&#39;db32&#39;</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;elim&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>
<span class="n">XR</span><span class="o">.</span><span class="n">shape</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal: &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$wv=db32$&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># ## Changing upper and lower bounds: $k_1$, $k_2$</span>

<span class="c1"># $k_1$ and $k_2$ are lower and upper bound on the threshold $\theta_\alpha$. $k_1$ is set to 10, which means, the lowest threshold value will be 10, this helps to prevent the removal of entire signal (zeroing out) due to present of high magnitute of artifact. $k_2$ is largest threshold value, which in terms set the decaying curve of threshold $\theta_\alpha$. Increasing k2 will make the removal less aggressive</span>

<span class="c1"># In[27]:</span>


<span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">wv</span><span class="o">=</span><span class="s1">&#39;db3&#39;</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;elim&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">k1</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">XR</span><span class="o">.</span><span class="n">shape</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal: &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$k_2=200$&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># ## Changing IPR -  Interpercentile range</span>

<span class="c1"># **IPR is interpercentile range**, which is set to 50% (IPR=[25,75]) as default (inter-quartile range), incresing the range increses the aggressiveness of removing artifacts.</span>

<span class="c1"># In[28]:</span>


<span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">wv</span><span class="o">=</span><span class="s1">&#39;db3&#39;</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;elim&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">k1</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">IPR</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">85</span><span class="p">])</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal: &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$IPR=[15,85]$~ 70%&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># ## Using the fix threshold $\theta_\alpha=300$,  to all the windows</span>

<span class="c1"># In[29]:</span>


<span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">wv</span><span class="o">=</span><span class="s1">&#39;db3&#39;</span><span class="p">,</span><span class="n">thr_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">theta_a</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;elim&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal: &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$\theta_\alpha=300$&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># ## Changing window length (5 sec)</span>

<span class="c1"># **winsize** is be default set to 128 (1 sec), assuming 128 sampling rate, which can be changed as needed. In following example it is changed to 5 sec.</span>

<span class="c1"># In[31]:</span>


<span class="n">XR</span> <span class="o">=</span> <a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">(</span><span class="n">Xf</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">winsize</span><span class="o">=</span><span class="mi">128</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">OptMode</span><span class="o">=</span><span class="s1">&#39;elim&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XR</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;XR: Corrected Signal: &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$winsize=5sec$&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,(</span><span class="n">Xf</span><span class="o">-</span><span class="n">XR</span><span class="p">)</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (sec)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="n">ch_names</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Xf - XR: Difference (removed signal)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="c1"># # Doc</span>

<span class="c1"># In[32]:</span>


<span class="n">help</span><span class="p">(</span><a href="../../modules/generated/spkit.eeg.ATAR.html#spkit.eeg.ATAR" title="spkit.eeg.ATAR" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR</span></a><span class="p">)</span>


<span class="c1"># In[35]:</span>


<span class="n">help</span><span class="p">(</span><a href="../../modules/generated/spkit.eeg.ATAR_1Ch.html#spkit.eeg.ATAR_1Ch" title="spkit.eeg.ATAR_1Ch" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR_1Ch</span></a><span class="p">)</span>


<span class="c1"># In[34]:</span>


<span class="n">help</span><span class="p">(</span><a href="../../modules/generated/spkit.eeg.ATAR_mCh.html#spkit.eeg.ATAR_mCh" title="spkit.eeg.ATAR_mCh" class="sphx-glr-backref-module-spkit-eeg sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">ATAR_mCh</span></a><span class="p">)</span>


<span class="c1"># In[ ]:</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 14.056 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-signal-processing-plot-sp-atar-algorithm-eeg-artifact-removal-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/spkit/spkit/0.9.X?urlpath=lab/tree/notebooks/auto_examples/signal_processing/plot_sp_ATAR_algorithm_eeg_artifact_removal.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo5.svg" width="150px" /></a>
</div>
<div class="lite-badge docutils container">
<a class="reference external image-reference" href="../../lite/lab/?path=auto_examples/signal_processing/plot_sp_ATAR_algorithm_eeg_artifact_removal.ipynb"><img alt="Launch JupyterLite" src="../../_images/jupyterlite_badge_logo5.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/80fa2675b88a42c956c4af6fcba615c4/plot_sp_ATAR_algorithm_eeg_artifact_removal.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sp_ATAR_algorithm_eeg_artifact_removal.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c6a536691689fb8d7646e4d171bf4ac5/plot_sp_ATAR_algorithm_eeg_artifact_removal.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sp_ATAR_algorithm_eeg_artifact_removal.py</span></code></a></p>
</div>
</div>
<p class="rubric">Related examples</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="# &lt;h1&gt;Table of Contents&lt;span class=&quot;tocSkip&quot;&gt;&lt;/span&gt;&lt;/h1&gt; # &lt;div class=&quot;toc&quot;&gt;&lt;ul class=&quot;toc-ite..."><img alt="" src="../../_images/sphx_glr_plot_sp_eeg_artifact_removal_ICA_thumb1.png" />
<p><a class="reference internal" href="plot_sp_eeg_artifact_removal_ICA.html#sphx-glr-auto-examples-signal-processing-plot-sp-eeg-artifact-removal-ica-py"><span class="std std-ref">EEG Artifact removal using ICA</span></a></p>
  <div class="sphx-glr-thumbnail-title">EEG Artifact removal using ICA</div>
</div><div class="sphx-glr-thumbcontainer" tooltip=" ATAR: Automatic and Tunable Artifact Removal Algorithm -  Tuning"><img alt="" src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_tuning_thumb.png" />
<p><a class="reference internal" href="../electroencephalogram/plot_sp_ATAR_algorithm_tuning.html#sphx-glr-auto-examples-electroencephalogram-plot-sp-atar-algorithm-tuning-py"><span class="std std-ref">ATAR: Automatic and Tunable Artifact Removal Algorithm</span></a></p>
  <div class="sphx-glr-thumbnail-title">ATAR: Automatic and Tunable Artifact Removal Algorithm</div>
</div><div class="sphx-glr-thumbcontainer" tooltip=" ATAR: Automatic and Tunable Artifact Removal Algorithm -  Tuning"><img alt="" src="../../_images/sphx_glr_plot_sp_ATAR_algorithm_tuning_thumb1.png" />
<p><a class="reference internal" href="plot_sp_ATAR_algorithm_tuning.html#sphx-glr-auto-examples-signal-processing-plot-sp-atar-algorithm-tuning-py"><span class="std std-ref">ATAR: Automatic and Tunable Artifact Removal Algorithm</span></a></p>
  <div class="sphx-glr-thumbnail-title">ATAR: Automatic and Tunable Artifact Removal Algorithm</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="ATAR: Automatic and Tunable Artifact Removal Algorithm"><img alt="" src="../../_images/sphx_glr_plot_sp_ATAR_algorith_eeg_artifact_removal_thumb.png" />
<p><a class="reference internal" href="plot_sp_ATAR_algorith_eeg_artifact_removal.html#sphx-glr-auto-examples-signal-processing-plot-sp-atar-algorith-eeg-artifact-removal-py"><span class="std std-ref">EEG Artifact removal using ATAR</span></a></p>
  <div class="sphx-glr-thumbnail-title">EEG Artifact removal using ATAR</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="ATAR: Automatic and Tunable Artifact Removal Algorithm"><img alt="" src="../../_images/sphx_glr_plot_sp_eeg_artifact_removal_ATAR_algorithm_thumb1.png" />
<p><a class="reference internal" href="plot_sp_eeg_artifact_removal_ATAR_algorithm.html#sphx-glr-auto-examples-signal-processing-plot-sp-eeg-artifact-removal-atar-algorithm-py"><span class="std std-ref">EEG Artifact removal using ATAR</span></a></p>
  <div class="sphx-glr-thumbnail-title">EEG Artifact removal using ATAR</div>
</div></div><p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


      </div>
      <div class="container">
        <footer class="spk-content-footer">
          &copy; 2019 - 2024, spkit developers (BSD License).
          <!-- -->
          <!-- <a href="../../_sources/auto_examples/signal_processing/plot_sp_ATAR_algorithm_eeg_artifact_removal.rst.txt" rel="nofollow">Show this page source</a> -->
          <!-- -->
        </footer>
      </div>

      <div class="container-fluid py-3">
        <hr>
        <div class="container spk-landing-container">
              <a class="spk-footer-funding-link" href="../../about.html">
              <div class="text-center">
                      <p class="mt-2">
                        Spkit developed in collabration with other projects:
                      </p>
                      <a href="https://PhyAAt.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../../_static/phyaat_logo.png" title="PhyAAt"></a>
                      <a href="https://PyLFSR.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../../_static/pylfsr_logo.png" title="PyLFSR" ></a>
                      <a href="https://MLEndDatasets.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../../_static/mlend_logo.png" title="MLEnd-Datasets" ></a>
                      <a href='https://clustrmaps.com/site/1b9h1'  title='Visit tracker'><img src='//clustrmaps.com/map_v2.png?cl=46b0cb&w=a&t=n&d=eQr8xSBiKVuSq6m0psK-Ey9TZ7rLzjRX-MpatyfFGQI&co=ffffff&ct=000000' width="30"/></a>

              </div>
              </a>
              <!-- <div style="width:3px;">
                <a href="https://clustrmaps.com/site/1b9h1"  title="Visit tracker"><img src="//www.clustrmaps.com/map_v2.png?d=eQr8xSBiKVuSq6m0psK-Ey9TZ7rLzjRX-MpatyfFGQI&cl=ffffff" /></a>  
              </div> -->
        </div>
      </div>
    </div>
  </div>
  <script src="../../_static/js/vendor/bootstrap.min.js"></script>
  
<script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-59299155-3', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<!-- 
<script defer data-domain="scikit-learn.org" src="https://views.scientific-python.org/js/script.js">
</script>
 -->

<script src="../../_static/clipboard.min.js"></script>
<script src="../../_static/copybutton.js"></script>

<script>
$(document).ready(function() {
    /* Add a [>>>] button on the top-right corner of code samples to hide
     * the >>> and ... prompts and the output and thus make the code
     * copyable. */
    var div = $('.highlight-python .highlight,' +
                '.highlight-python3 .highlight,' +
                '.highlight-pycon .highlight,' +
		        '.highlight-default .highlight')
    var pre = div.find('pre');

    // get the styles from the current theme
    pre.parent().parent().css('position', 'relative');

    // create and add the button to all the code blocks that contain >>>
    div.each(function(index) {
        var jthis = $(this);
        // tracebacks (.gt) contain bare text elements that need to be
        // wrapped in a span to work with .nextUntil() (see later)
        jthis.find('pre:has(.gt)').contents().filter(function() {
            return ((this.nodeType == 3) && (this.data.trim().length > 0));
        }).wrap('<span>');
    });

	/*** Add permalink buttons next to glossary terms ***/
	$('dl.glossary > dt[id]').append(function() {
		return ('<a class="headerlink" href="#' +
			    this.getAttribute('id') +
			    '" title="Permalink to this term">¶</a>');
	});
});

</script>
    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    
</body>

</html>