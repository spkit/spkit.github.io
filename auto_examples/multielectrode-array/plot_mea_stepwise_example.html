

<!DOCTYPE html>
<!-- data-theme below is forced to be "light" but should be changed if we use pydata-theme-sphinx in the future -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" data-content_root="../../" data-theme="light"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en" data-content_root="../../" data-theme="light">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="MEA: Step-wise Analysis: Example" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://spkit.github.io/auto_examples/multielectrode-array/plot_mea_stepwise_example.html" />
<meta property="og:site_name" content="spkit" />
<meta property="og:description" content="In this example code, we demonstrate analysis of MEA Recording, with each step. There are 13 steps. Read HDF File, Stim loc, Align Cycles, Average Cycles/Select one, Activation Time, Activation & R..." />
<meta property="og:image" content="https://github.com/spkit/spkit.github.io/blob/master/assets/logo/logo.png" />
<meta property="og:image:alt" content="spkit" />
<meta name="description" content="In this example code, we demonstrate analysis of MEA Recording, with each step. There are 13 steps. Read HDF File, Stim loc, Align Cycles, Average Cycles/Select one, Activation Time, Activation & R..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>MEA: Step-wise Analysis: Example &mdash; spkit 0.0.9.7 documentation</title>
  
  <link rel="canonical" href="http://spkit.github.io/stable/auto_examples/multielectrode-array/plot_mea_stepwise_example.html" />

  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  <link rel="stylesheet" href="../../_static/css/vendor/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../../https://fonts.googleapis.com/css?family=Vibur" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyterlite_sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <script id="documentation_options" data-url_root="../../"
    src="../../_static/documentation_options.js"></script>
  <script src="../../_static/js/vendor/jquery-3.6.3.slim.min.js"></script>
  <script src="../../_static/js/details-permalink.js"></script>

  <link rel="stylesheet" href="../../_static/css/vendor/nature_spkit.css" type="text/css" /> 


</head>

<body>
  





<!-- ('About us', pathto('about'), ''), -->


<div id="logo-banner">
  <div class="logo">
    <!-- <a href="../../%23.html"><img src="_static/spkit_logo.png" alt="spkit logo"  border="0" /></a> -->
  <!-- <a href="#"><img src="_static/spkit_logo.png" alt="spkit logo"  border="0" /></a> -->
  <a href="../../index.html"><img src="../../_static/spkit_logo.png" alt="spkit logo"  border="0" /></a>
  </div>
  <div class="tags">
  <ul>
    <li>&#9672; Easy to use toolkit for signal processing and analysis</li>
    <li>&#9672; More of biomedical signal analysis with visualization</li>
    <li>&#9672; Includes basic machine learning models with visualization</li>
    <!-- <li>&#9672; Open source</li> -->
  </ul>
  </div>
  <div class="banner">
  <h2>Signal Processing Toolkit</h2>
  <h4><i>Simple and easy to use for signal analysis and predictive analysis</i></h4>
  </div>
</div>
<nav id="navbar" class="spk-docs-navbar navbar navbar-expand-md navbar-light bg-light py-0">
  <div class="container-fluid spk-docs-container px-0">
      <a class="navbar-brand py-0" href="../../index.html">
        <img
          class="spk-brand-img"
          src="../../_static/spkit_small_icon_v.png"
          alt="logo"/>
      </a>
    <button
      id="spk-navbar-toggler"
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="spk-navbar-collapse collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../index.html">Home</a>
        </li>
        <!-- <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../install.html">Install</a>
        </li> -->
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../user_guide.html">User Guide</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../modules/classes.html">API</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../index.html">Examples</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../tutorials/index.html">Tutorials</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" target="_blank" rel="noopener noreferrer" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=">Discussion Forum</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link" href="../../about.html">About Us</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="../../getting_started.html" >Getting Started</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="../../whats_new/v0.0.9.7.html" >What's new</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://github.com/nikeshbajaj/spkit" >GitHub</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://spkit.github.io/dev/index.html" target="_blank" rel="noopener noreferrer">Development</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=" >Get Involved</a>
        </li>
        <li class="nav-item">
          <a class="spk-nav-link nav-link nav-more-item-mobile-items" href="https://spkit.github.io/dev/versions.html" >Other Versions and Download</a>
        </li>
        <li class="nav-item dropdown nav-more-item-dropdown">
          <a class="spk-nav-link nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="spk-nav-dropdown-item dropdown-item" href="../../getting_started.html" >Getting Started</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="../../whats_new/v0.0.9.7.html" >What's new</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://github.com/nikeshbajaj/spkit" >GitHub</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://spkit.github.io/dev/index.html" target="_blank" rel="noopener noreferrer">Development</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://github.com/Nikeshbajaj/spkit/discussions?discussions_q=" >Get Involved</a>
              <a class="spk-nav-dropdown-item dropdown-item" href="https://spkit.github.io/dev/versions.html" >Other Versions and Download</a>
          </div>
        </li>
      </ul>
      <div id="searchbox" role="search">
          <div class="searchformwrapper">
          <form class="search" action="../../search.html" method="get">
            <input class="spk-search-text-input" type="text" name="q" aria-labelledby="searchlabel" />
            <input class="spk-search-text-btn" type="submit" value="Go" />
          </form>
          </div>
      </div>
      <a class ="nav-more-item-dropdown">
      <font size="4em" style="margin: 5px 5px 0px 5px;color:rgb(0, 0, 0)">V</font>
      </a>
      <div class="nav-item dropdown nav-more-item-dropdown-vs">
        <a class="sp-nav-link nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <font color="black">0.0.9.7 (latest)</font>
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="sp-nav-dropdown-item dropdown-item" href="../../index.html" >0.0.9.7 (latest)</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.6/index.html" >0.0.9.6</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.5/index.html" >0.0.9.5</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.4/index.html" >0.0.9.4</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.3/index.html" >0.0.9.3</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.2/index.html" >0.0.9.2</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="../../V/0.0.9.1/index.html" >0.0.9.1</a>
            <a class="sp-nav-dropdown-item dropdown-item" href="https://github.com/Nikeshbajaj/spkit/releases" >More</a>
        </div>
      </div>
    </div>
  </div>
</nav>
  <div class="d-flex" id="spk-doc-wrapper" class="border-right">
    <input type="checkbox" name="spk-toggle-checkbox" id="spk-toggle-checkbox">
    <label id="spk-sidemenu-toggle" class="spk-btn-toggle-toc btn spk-btn-primary" for="spk-toggle-checkbox">Toggle
      Menu</label>
      <div id="spk-sidebar-top-logoimg">
        <a href="../../index.html">
          <img class="spk-brand-img-side" src="../../_static/spkit_logo.png" alt="spkit logo"  border="0" />
        </a>
      </div>
    <div id="spk-sidebar-wrapper" class="border-right">
      <div class="spk-sidebar-top-content">
        <hr style="margin: 0 0 10px 0" />
        <div class="alert alert-danger p-1 mb-2" role="alert">
          <p class="text-center mb-0">
            <strong>SpKit 0.0.9.7</strong><br />
            <!-- <a class="reference external" href="https://pypi.org/project/spkit" target="_blank"><img alt="GitHub release (latest SemVer)" src="https://img.shields.io/github/v/release/Nikeshbajaj/spkit?label=latest%20version&style=plastic"></a> -->
            <a class="reference external" href="https://pepy.tech/project/spkit" target="_blank"><img
                src="https://static.pepy.tech/personalized-badge/spkit?period=total&amp;units=international_system&amp;left_color=black&amp;right_color=orange&amp;left_text=downloads"
                alt="PyPI - Downloads" /></a>
            <a class="reference external" href="https://pypi.python.org/pypi/spkit" target="_blank"><img
                alt="PyPI - Downloads" src="https://img.shields.io/pypi/dm/spkit?style=plastic"></a>
            <!-- <a href="http://spkit.github.io/dev/versions.html">Other versions</a> -->
          </p>
        </div>
        <div class="alert alert-warning p-1 mb-2" role="alert">
          <p class="text-center mb-0">
            Please <a class="font-weight-bold" href="../../about.html#citing">
              <string>cite us</string>
            </a> if you use the software.
          </p>
        </div>
        <div class="btn-group w-100 mb-2" role="group" aria-label="rellinks">
          <a href="plot_mea_minimal_setting_example.html" role="button" class="btn spk-btn-rellink py-1"
            spk-rellink-tooltip="MEA: Minimal Setting: Example">Prev</a><a href=" index.html" role="button" class="btn spk-btn-rellink py-1"
            spk-rellink-tooltip="Multi-Electrode-Array (MEA)">Up</a>
          <a href="../release_highlights/index.html" role="button" class="btn spk-btn-rellink py-1"
            spk-rellink-tooltip="Release Highlights">Next</a>
        </div>
        <hr>
      </div>
      <div class=" spk-sidebar-toc-wrapper">
          <!-- <div class="btn-group w-100 mb-2" role="group" aria-label="rellinks">
            <a href="plot_mea_minimal_setting_example.html" role="button" class="btn spk-btn-rellink py-1"
              spk-rellink-tooltip="MEA: Minimal Setting: Example">Prev</a><a href=" index.html" role="button" class="btn spk-btn-rellink py-1"
              spk-rellink-tooltip="Multi-Electrode-Array (MEA)">Up</a>
            <a href="../release_highlights/index.html" role="button" class="btn spk-btn-rellink py-1"
              spk-rellink-tooltip="Release Highlights">Next</a>
          </div>
          <hr> -->
          <div class="spk-sidebar-toc">
            <ul>
<li><a class="reference internal" href="#">MEA: Step-wise Analysis: Example</a><ul>
<li><a class="reference internal" href="#step-1-read-file">Step 1: Read File</a></li>
<li><a class="reference internal" href="#step-2-stim-localisation">Step 2: Stim Localisation</a></li>
<li><a class="reference internal" href="#step-3-align-cycles">Step 3: Align Cycles</a></li>
<li><a class="reference internal" href="#step-4-average-cycles-or-select-one">Step 4: Average Cycles or Select one</a></li>
<li><a class="reference internal" href="#step-5-6-activation-and-repolarisation-time">Step 5-6: Activation and Repolarisation Time</a></li>
<li><a class="reference internal" href="#step-7-apd-computation">Step 7: APD Computation</a></li>
<li><a class="reference internal" href="#step-8-extract-egms">Step 8: Extract EGMs</a></li>
<li><a class="reference internal" href="#step-9-egm-feature-extraction">Step 9: EGM Feature Extraction</a></li>
<li><a class="reference internal" href="#step-10-bad-channels">Step 10: BAD Channels</a></li>
<li><a class="reference internal" href="#step-11-feature-matrix">Step 11: Feature Matrix</a></li>
<li><a class="reference internal" href="#step-12-interpolating-activation-map">Step 12: Interpolating Activation Map</a></li>
<li><a class="reference internal" href="#step-13-computing-conduction-velocity-and-maps">Step 13: Computing Conduction Velocity and maps</a></li>
</ul>
</li>
</ul>

          </div>
      </div>
      <br>
      <br>
      <br>
      <br>
      <br>
    </div>
    <div id="spk-page-content-wrapper">
      <div class="spk-page-content container-fluid body px-md-3" role="main">
        
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-multielectrode-array-plot-mea-stepwise-example-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code or to run this example in your browser via JupyterLite or Binder</p>
</div>
<section class="sphx-glr-example-title" id="mea-step-wise-analysis-example">
<span id="sphx-glr-auto-examples-multielectrode-array-plot-mea-stepwise-example-py"></span><h1>MEA: Step-wise Analysis: Example<a class="headerlink" href="#mea-step-wise-analysis-example" title="Link to this heading">¶</a></h1>
<p>In this example code, we demonstrate analysis of MEA Recording, with each step. There are 13 steps.</p>
<ol class="arabic simple">
<li><p>Read HDF File</p></li>
<li><p>Stim loc</p></li>
<li><p>Align Cycles</p></li>
<li><p>Average Cycles/Select one</p></li>
<li><p>Activation Time</p></li>
<li><p>Activation &amp; Repolarisation Time</p></li>
<li><p>APD computation</p></li>
<li><p>Extract EGM</p></li>
<li><p>EGM Feature Extraction</p></li>
<li><p>BAD Channels</p></li>
<li><p>Feature Matrix</p></li>
<li><p>Interpolation</p></li>
<li><p>Conduction Velocity</p></li>
</ol>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1">#sp.mea</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spkit-version: &#39;</span><span class="p">,</span><span class="n">sp</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="c1"># Download Sample file if not done already</span>

<span class="n">file_name</span><span class="o">=</span> <span class="s1">&#39;MEA_Sample_North_1000mV_1Hz.h5&#39;</span>

<span class="k">if</span> <span class="ow">not</span><span class="p">(</span><a href="https://docs.python.org/3/library/os.path.html#os.path.exists" title="os.path.exists" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span></a><span class="p">(</span><span class="n">file_name</span><span class="p">)):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;https://spkit.github.io/data_samples/files/MEA_Sample_North_1000mV_1Hz.h5&#39;</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>spkit-version:  0.0.9.7
</pre></div>
</div>
<section id="step-1-read-file">
<h2>Step 1: Read File<a class="headerlink" href="#step-1-read-file" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">25000</span>
<span class="n">X</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">ch_labels</span> <span class="o">=</span> <a href="../../modules/generated/spkit.io.read_hdf.html#spkit.io.read_hdf" title="spkit.io.read_hdf" class="sphx-glr-backref-module-spkit-io sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_hdf</span></a><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>base key(s) found in file &lt;KeysViewHDF5 [&#39;Data&#39;]&gt;
Shape of Signals:  (60, 250000)
- #Channels    = 60
- Duration (s) = 10.0
</pre></div>
</div>
</section>
<section id="step-2-stim-localisation">
<h2>Step 2: Stim Localisation<a class="headerlink" href="#step-2-stim-localisation" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">stim_fhz</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">stim_loc</span><span class="p">,</span><span class="n">_</span>  <span class="o">=</span> <a href="../../modules/generated/spkit.mea.get_stim_loc.html#spkit.mea.get_stim_loc" title="spkit.mea.get_stim_loc" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">get_stim_loc</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">fhz</span><span class="o">=</span><span class="n">stim_fhz</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">stim_loc_ms</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">stim_loc</span><span class="p">)</span><span class="o">/</span><span class="n">fs</span>


<span class="n">t</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">fs</span>
<span class="n">sep</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">tix</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">*</span><span class="n">sep</span>
<span class="n">tiy</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tiy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span><span class="mi">1</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">tix</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">tiy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sep</span><span class="p">,</span><span class="n">tiy</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s1">&#39;Channel #&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (ms)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Full recording of channels&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html#matplotlib.pyplot.xticks" title="matplotlib.pyplot.xticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span></a><span class="p">(</span><span class="n">stim_loc_ms</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.tight_layout.html#matplotlib.pyplot.tight_layout" title="matplotlib.pyplot.tight_layout" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_001.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_001.png" alt="Stimulus spikes loc., average duration = 25000.67 samples, Stimulus spikes time (s), average duration = 1.0 s" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_002.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_002.png" alt="Full recording of channels" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>-#cycles= 10
</pre></div>
</div>
</section>
<section id="step-3-align-cycles">
<h2>Step 3: Align Cycles<a class="headerlink" href="#step-3-align-cycles" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">exclude_first_dur</span><span class="o">=</span><span class="mi">2</span>
<span class="n">dur_after_spike</span><span class="o">=</span><span class="mi">500</span>
<span class="n">exclude_last_cycle</span><span class="o">=</span><span class="kc">True</span>

<span class="n">XB</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.align_cycles.html#spkit.mea.align_cycles" title="spkit.mea.align_cycles" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">align_cycles</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">stim_loc</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">exclude_first_dur</span><span class="o">=</span><span class="n">exclude_first_dur</span><span class="p">,</span><span class="n">dur_after_spike</span><span class="o">=</span><span class="n">dur_after_spike</span><span class="p">,</span>
                         <span class="n">exclude_last_cycle</span><span class="o">=</span><span class="n">exclude_last_cycle</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of EGMs/Cycles per channel =&#39;</span><span class="p">,</span><span class="n">XB</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ch</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">XB</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">fs</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">XB</span><span class="p">[</span><span class="n">ch</span><span class="p">,:,:])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.grid.html#matplotlib.pyplot.grid" title="matplotlib.pyplot.grid" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">XB</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1"> Cycles (Alinged) of Channel: </span><span class="si">{</span><span class="n">ch</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (ms)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_mea_stepwise_example_003.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_003.png" alt="9 Cycles (Alinged) of Channel: 0" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Shape: (60, 12450, 9)
Number of EGMs/Cycles per channel = 9
</pre></div>
</div>
</section>
<section id="step-4-average-cycles-or-select-one">
<h2>Step 4: Average Cycles or Select one<a class="headerlink" href="#step-4-average-cycles-or-select-one" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">egm_number</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="k">if</span> <span class="n">egm_number</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">X1B</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.nanmean.html#numpy.nanmean" title="numpy.nanmean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span></a><span class="p">(</span><span class="n">XB</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; -- Averaged All EGM&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># egm_number should be between from 0 to &#39;Number of EGMs/Cycles per channel &#39;</span>
    <span class="k">assert</span> <span class="n">egm_number</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">XB</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">X1B</span> <span class="o">=</span> <span class="n">XB</span><span class="p">[:,:,</span><span class="n">egm_number</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; -- Selected EGM -&gt;&#39;</span><span class="p">,</span><span class="n">egm_number</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;EGM Shape : &#39;</span><span class="p">,</span><span class="n">X1B</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> -- Averaged All EGM
EGM Shape :  (60, 12450)
</pre></div>
</div>
</section>
<section id="step-5-6-activation-and-repolarisation-time">
<h2>Step 5-6: Activation and Repolarisation Time<a class="headerlink" href="#step-5-6-activation-and-repolarisation-time" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1">#at_range = [0,100]</span>
<span class="c1">#rt_range = [2,100]</span>
<span class="n">at_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>
<span class="n">rt_range</span><span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

<span class="c1"># for only activation</span>
<span class="n">at_loc</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.activation_time_loc.html#spkit.mea.activation_time_loc" title="spkit.mea.activation_time_loc" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">activation_time_loc</span></a><span class="p">(</span><span class="n">X1B</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">at_range</span><span class="o">=</span><span class="n">at_range</span><span class="p">)</span>

<span class="c1"># for only activation and repolarisation together</span>
<span class="n">at_loc</span><span class="p">,</span> <span class="n">rt_loc</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.activation_repol_time_loc.html#spkit.mea.activation_repol_time_loc" title="spkit.mea.activation_repol_time_loc" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">activation_repol_time_loc</span></a><span class="p">(</span><span class="n">X1B</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">at_range</span><span class="o">=</span><span class="n">at_range</span><span class="p">,</span> <span class="n">rt_range</span><span class="o">=</span><span class="n">rt_range</span><span class="p">)</span>

<span class="n">at_loc_ms</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="n">at_loc</span><span class="o">/</span><span class="n">fs</span>
<span class="n">rt_loc_ms</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="n">rt_loc</span><span class="o">/</span><span class="n">fs</span>

<span class="n">at_loc_ms</span><span class="p">,</span> <span class="n">rt_loc_ms</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(array([ 16.64,  19.56,  13.96,  10.88,  19.52,  16.88,  20.04,  14.04,
       323.44,  18.6 ,  14.84,  16.16,  11.48,  12.4 , 284.08,  10.64,
         9.48,   8.24,   9.  ,   7.  ,   8.04,   5.  ,   5.48, 174.48,
         2.72, 176.4 ,   8.04, 357.  , 394.88,   1.84, 349.76, 345.48,
         4.72,   7.88, 209.08,   1.48, 201.6 ,   4.64,   2.68,   4.12,
       330.32,   6.56,   7.56,   7.92,   9.24, 343.92,  10.96,  10.52,
        14.32,  13.76,  17.12,  16.68,  13.6 ,  19.68,  16.48,  19.48,
        11.16,  13.92,  19.52,  16.76]), array([349.76, 323.4 , 278.08,  44.6 , 472.64, 120.6 , 424.96, 472.64,
       340.32, 302.92, 271.48, 472.64,  16.16,  16.16, 314.8 ,  11.36,
        10.68,   9.52,  12.04,   9.12,  44.6 , 429.52, 407.48, 202.68,
       342.48, 201.6 , 351.84, 357.96, 419.36, 425.  , 351.88, 351.84,
       316.36, 460.  , 219.32, 278.08, 235.56, 295.76, 323.4 , 323.4 ,
       343.92, 349.76, 342.48, 202.68, 330.28, 357.04, 351.84, 145.2 ,
       245.88, 472.64, 278.08, 323.4 , 397.28, 295.76, 349.76, 349.76,
        44.6 ,  44.6 ,  83.16,  93.72]))
</pre></div>
</div>
</section>
<section id="step-7-apd-computation">
<h2>Step 7: APD Computation<a class="headerlink" href="#step-7-apd-computation" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">apd_ms</span> <span class="o">=</span> <span class="n">rt_loc_ms</span><span class="o">-</span><span class="n">at_loc_ms</span>

<span class="n">AT_grid</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.arrange_mea_grid.html#spkit.mea.arrange_mea_grid" title="spkit.mea.arrange_mea_grid" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">arrange_mea_grid</span></a><span class="p">(</span><span class="n">at_loc_ms</span><span class="p">,</span> <span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">)</span>
<span class="n">RT_grid</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.arrange_mea_grid.html#spkit.mea.arrange_mea_grid" title="spkit.mea.arrange_mea_grid" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">arrange_mea_grid</span></a><span class="p">(</span><span class="n">rt_loc_ms</span><span class="p">,</span> <span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">)</span>
<span class="n">APD_grid</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.arrange_mea_grid.html#spkit.mea.arrange_mea_grid" title="spkit.mea.arrange_mea_grid" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">arrange_mea_grid</span></a><span class="p">(</span><span class="n">apd_ms</span><span class="p">,</span> <span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a href="../../modules/generated/spkit.mea.mat_1_show.html#spkit.mea.mat_1_show" title="spkit.mea.mat_1_show" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mat_1_show</span></a><span class="p">(</span><span class="n">AT_grid</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">),</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Activation Time&#39;</span><span class="p">)</span>
<a href="../../modules/generated/spkit.mea.mat_1_show.html#spkit.mea.mat_1_show" title="spkit.mea.mat_1_show" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mat_1_show</span></a><span class="p">(</span><span class="n">RT_grid</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">),</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Repolarisation Time&#39;</span><span class="p">)</span>
<a href="../../modules/generated/spkit.mea.mat_1_show.html#spkit.mea.mat_1_show" title="spkit.mea.mat_1_show" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mat_1_show</span></a><span class="p">(</span><span class="n">APD_grid</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">),</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;APD&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.tight_layout.html#matplotlib.pyplot.tight_layout" title="matplotlib.pyplot.tight_layout" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_mea_stepwise_example_004.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_004.png" alt="Activation Time, Repolarisation Time, APD" class = "sphx-glr-single-img"/></section>
<section id="step-8-extract-egms">
<h2>Step 8: Extract EGMs<a class="headerlink" href="#step-8-extract-egms" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dur_from_loc</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">remove_drift</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">XE</span><span class="p">,</span><span class="n">ATloc</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.extract_egm.html#spkit.mea.extract_egm" title="spkit.mea.extract_egm" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">extract_egm</span></a><span class="p">(</span><span class="n">X1B</span><span class="p">,</span><span class="n">act_loc</span><span class="o">=</span><span class="n">at_loc</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">dur_from_loc</span><span class="o">=</span><span class="n">dur_from_loc</span><span class="p">,</span><span class="n">remove_drift</span><span class="o">=</span><span class="n">remove_drift</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">XE</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ATloc</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(60, 250) (60,)
</pre></div>
</div>
</section>
<section id="step-9-egm-feature-extraction">
<h2>Step 9: EGM Feature Extraction<a class="headerlink" href="#step-9-egm-feature-extraction" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">EGM_feat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">XE</span><span class="p">)):</span>
    <span class="n">egmf</span><span class="p">,</span> <span class="n">feat_names</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.egm_features.html#spkit.mea.egm_features" title="spkit.mea.egm_features" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">egm_features</span></a><span class="p">(</span><span class="n">XE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">act_loc</span><span class="o">=</span><span class="n">ATloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">width_rel_height</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                   <span class="n">findex_rel_dur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">findex_rel_height</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">findex_npeak</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">EGM_feat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">egmf</span><span class="p">)</span>

<span class="c1">#XE = np.array(XE)</span>
<span class="c1">#ATloc = np.array(ATloc)</span>
<span class="n">EGM_feat</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">EGM_feat</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Following EGM Features are etracted: &#39;</span><span class="p">,</span> <span class="n">feat_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;EGM_Feat shape :&#39;</span><span class="p">,</span><span class="n">EGM_feat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shapes: XE =&#39;</span><span class="p">,</span><span class="n">XE</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;, AT =&#39;</span><span class="p">,</span><span class="n">ATloc</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s1">&#39;, EGM_F=&#39;</span> <span class="p">,</span><span class="n">EGM_feat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>----------------------------------------------------------------------------------------------------
Following EGM Features are etracted:  [&#39;peak_to_peak&#39;, &#39;egm_duration&#39;, &#39;f_index&#39;, &#39;new_duration&#39;, &#39;energy_mean&#39;, &#39;energy_sd&#39;, &#39;noise_var&#39;]
EGM_Feat shape : (60, 7)
Shapes: XE = (60, 250) , AT = (60,) , EGM_F= (60, 7)
----------------------------------------------------------------------------------------------------
</pre></div>
</div>
</section>
<section id="step-10-bad-channels">
<h2>Step 10: BAD Channels<a class="headerlink" href="#step-10-bad-channels" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1">#=============STEP 10.1: BAD Channel (1) ================================</span>
<span class="n">good_channels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bad_channels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">]</span>

<span class="n">p2p_thr</span><span class="o">=</span><span class="mi">5</span>
<span class="n">bad_ch_stim_thr</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">bad_ch_mnmx</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

<span class="n">range_act_thr</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>

<span class="n">bad_channels_list</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">bad_channels_idx_1</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">bad_channels_idx_1</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.find_bad_channels_idx.html#spkit.mea.find_bad_channels_idx" title="spkit.mea.find_bad_channels_idx" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">find_bad_channels_idx</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">thr</span><span class="o">=</span><span class="n">bad_ch_stim_thr</span><span class="p">,</span><span class="n">stim_fhz</span><span class="o">=</span><span class="n">stim_fhz</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span>
                    <span class="n">mnmx</span><span class="o">=</span><span class="n">bad_ch_mnmx</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">plot_dur</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bad_channels_ch_1</span>  <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">[</span><span class="n">bad_channels_idx_1</span><span class="p">])</span>
<span class="n">bad_channels_list</span>  <span class="o">=</span> <span class="n">bad_channels_list</span> <span class="o">+</span> <span class="n">bad_channels_ch_1</span>
<span class="n">bad_channels_list</span>  <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">bad_channels_list</span><span class="p">))</span>
<span class="n">bad_channels_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="c1">#=============STEP 10.2: BAD Channel (2) ================================</span>
<span class="n">bad_channels_idx_2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bad_channels_idx_2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">EGM_feat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">p2p_thr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bad_channels_ch_2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">[</span><span class="n">bad_channels_idx_2</span><span class="p">])</span>
<span class="n">bad_channels_list</span> <span class="o">=</span> <span class="n">bad_channels_list</span> <span class="o">+</span> <span class="n">bad_channels_ch_2</span>


<span class="c1">#=============STEP 10.3: BAD Channel (3) ================================</span>
<span class="n">bad_channels_idx_3</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">bad_channels_idx_3</span> <span class="o">=</span> <span class="n">bad_channels_idx_3</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">at_loc_ms</span><span class="o">&lt;</span><span class="n">range_act_thr</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">bad_channels_idx_3</span> <span class="o">=</span> <span class="n">bad_channels_idx_3</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">at_loc_ms</span><span class="o">&gt;</span><span class="n">range_act_thr</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">bad_channels_ch_3</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">[</span><span class="n">bad_channels_idx_3</span><span class="p">])</span>
<span class="n">bad_channels_list</span> <span class="o">=</span> <span class="n">bad_channels_list</span> <span class="o">+</span> <span class="n">bad_channels_ch_3</span>

<span class="n">bad_channels_list</span> <span class="o">=</span> <span class="n">bad_channels_list</span> <span class="o">+</span> <span class="n">bad_channels</span>
<span class="n">bad_channels_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">bad_channels_list</span><span class="p">))</span>
<span class="n">bad_channels_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">good_channels</span><span class="p">):</span>
    <span class="n">bad_channels_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">bad_channels_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">good_channels</span><span class="p">))</span>
    <span class="n">bad_channels_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>


<span class="n">good_channels_list</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">ch_labels</span> <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_channels_list</span><span class="p">])</span>
<span class="n">good_channels_list_idx</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">ch_labels</span> <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_channels_list</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BAD CHANNELS&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- BASED ON STIM thr =&#39;</span><span class="p">,</span> <span class="n">bad_ch_stim_thr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - ch:&#39;</span><span class="p">,</span> <span class="n">bad_channels_ch_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- BASED ON Peak-to-Peak volt thr:&#39;</span><span class="p">,</span><span class="n">p2p_thr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - ch:&#39;</span><span class="p">,</span> <span class="n">bad_channels_ch_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- BASED ON Activation time (ms) range thr:&#39;</span><span class="p">,</span> <span class="n">range_act_thr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - ch:&#39;</span><span class="p">,</span> <span class="n">bad_channels_ch_3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- Manually passed:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - ch:&#39;</span><span class="p">,</span> <span class="n">bad_channels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GOOD CHANNELS passed:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  - ch:&#39;</span><span class="p">,</span><span class="n">good_channels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final list of Bad Channels:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; - ch:&#39;</span><span class="p">,</span><span class="n">bad_channels_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final list of Good Channels:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; - ch:&#39;</span><span class="p">,</span><span class="n">good_channels_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>


<a href="../../modules/generated/spkit.mea.plot_mea_grid.html#spkit.mea.plot_mea_grid" title="spkit.mea.plot_mea_grid" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">plot_mea_grid</span></a><span class="p">(</span><span class="n">X1B</span><span class="p">,</span><span class="n">act_spikes</span><span class="o">=</span><span class="n">at_loc</span><span class="p">,</span><span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">,</span><span class="n">bad_channels</span><span class="o">=</span><span class="n">bad_channels_list</span><span class="p">,</span>
                     <span class="n">xlim</span><span class="o">=</span><span class="n">at_range</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">title_style</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Time Trace + AT&#39;</span><span class="p">)</span>

<a href="../../modules/generated/spkit.mea.plot_mea_grid.html#spkit.mea.plot_mea_grid" title="spkit.mea.plot_mea_grid" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">plot_mea_grid</span></a><span class="p">(</span><span class="n">XE</span><span class="p">,</span><span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">,</span><span class="n">bad_channels</span><span class="o">=</span><span class="n">bad_channels_list</span><span class="p">,</span>
                     <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">title_style</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Electrograms (EGMs)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_005.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_005.png" alt="Time Trace + AT, 47, 48, 46, 45, 38, 37, 28, 36, 27, 17, 26, 16, 35, 25, 15, 14, 24, 34, 13, 23, 12, 22, 33, 21, 32, 31, 44, 43, 41, 42, 52, 51, 53, 54, 61, 62, 71, 63, 72, 82, 73, 83, 64, 74, 84, 85, 75, 65, 86, 76, 87, 77, 66, 78, 67, 68, 55, 56, 58, 57" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_006.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_006.png" alt="Electrograms (EGMs), 47, 48, 46, 45, 38, 37, 28, 36, 27, 17, 26, 16, 35, 25, 15, 14, 24, 34, 13, 23, 12, 22, 33, 21, 32, 31, 44, 43, 41, 42, 52, 51, 53, 54, 61, 62, 71, 63, 72, 82, 73, 83, 64, 74, 84, 85, 75, 65, 86, 76, 87, 77, 66, 78, 67, 68, 55, 56, 58, 57" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>----------------------------------------------------------------------------------------------------
BAD CHANNELS
- BASED ON STIM thr = 2
  - ch: [21, 31, 43, 41, 51, 61, 71]
- BASED ON Peak-to-Peak volt thr: 5
  - ch: [15, 21, 31, 43, 41, 52, 51, 61, 71]
- BASED ON Activation time (ms) range thr: [0, 50]
  - ch: [27, 15, 21, 31, 43, 41, 52, 51, 61, 71, 73, 85]
- Manually passed:
  - ch: [15]
GOOD CHANNELS passed:
  - ch: []
--------------------------------------------------
Final list of Bad Channels:
 - ch: [15, 21, 27, 31, 41, 43, 51, 52, 61, 71, 73, 85]
Final list of Good Channels:
 - ch: [47 48 46 45 38 37 28 36 17 26 16 35 25 14 24 34 13 23 12 22 33 32 44 42
 53 54 62 63 72 82 83 64 74 84 75 65 86 76 87 77 66 78 67 68 55 56 58 57]
----------------------------------------------------------------------------------------------------
-852.8768781599376 1088.2322322933303
</pre></div>
</div>
</section>
<section id="step-11-feature-matrix">
<h2>Step 11: Feature Matrix<a class="headerlink" href="#step-11-feature-matrix" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">Ax</span><span class="p">,</span><span class="n">Mxbad</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.mea_feature_map.html#spkit.mea.mea_feature_map" title="spkit.mea.mea_feature_map" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mea_feature_map</span></a><span class="p">(</span><span class="n">at_loc_ms</span><span class="p">,</span><span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">,</span><span class="n">bad_channels</span><span class="o">=</span><span class="n">bad_channels_list</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                               <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Activation Time&#39;</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.mea_feature_map.html#spkit.mea.mea_feature_map" title="spkit.mea.mea_feature_map" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mea_feature_map</span></a><span class="p">(</span><span class="n">EGM_feat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">,</span><span class="n">bad_channels</span><span class="o">=</span><span class="n">bad_channels_list</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                               <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mV&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Peak-to-Peak&#39;</span><span class="p">)</span>


<span class="n">_</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.mea_feature_map.html#spkit.mea.mea_feature_map" title="spkit.mea.mea_feature_map" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mea_feature_map</span></a><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">EGM_feat</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">fs</span><span class="p">,</span><span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">,</span><span class="n">bad_channels</span><span class="o">=</span><span class="n">bad_channels_list</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                               <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;EGM Duration&#39;</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.mea_feature_map.html#spkit.mea.mea_feature_map" title="spkit.mea.mea_feature_map" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mea_feature_map</span></a><span class="p">(</span><span class="n">EGM_feat</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">ch_labels</span><span class="o">=</span><span class="n">ch_labels</span><span class="p">,</span><span class="n">bad_channels</span><span class="o">=</span><span class="n">bad_channels_list</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                               <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;F-index&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Fractionation Index&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.0f&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_007.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_007.png" alt="Activation Time, Activation Time (- bad channels)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_008.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_008.png" alt="Peak-to-Peak, Peak-to-Peak (- bad channels)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_009.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_009.png" alt="EGM Duration, EGM Duration (- bad channels)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_010.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_010.png" alt="Fractionation Index, Fractionation Index (- bad channels)" class = "sphx-glr-multi-img"/></li>
</ul>
</section>
<section id="step-12-interpolating-activation-map">
<h2>Step 12: Interpolating Activation Map<a class="headerlink" href="#step-12-interpolating-activation-map" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">range_act_thr</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">intp_param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pkind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">filter_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;conv&#39;</span><span class="p">)</span>

<span class="n">AxI</span><span class="p">,</span> <span class="n">AxIx</span> <span class="o">=</span> <a href="../../modules/generated/spkit.fill_nans_2d.html#spkit.fill_nans_2d" title="spkit.fill_nans_2d" class="sphx-glr-backref-module-spkit sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">fill_nans_2d</span></a><span class="p">(</span><span class="n">Ax</span><span class="o">*</span><span class="n">Mxbad</span><span class="p">,</span><span class="n">clip_range</span><span class="o">=</span><span class="n">range_act_thr</span><span class="p">,</span><span class="o">**</span><span class="n">intp_param</span><span class="p">)</span>




<a href="../../modules/generated/spkit.mea.mat_list_show.html#spkit.mea.mat_list_show" title="spkit.mea.mat_list_show" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mat_list_show</span></a><span class="p">([</span><span class="n">Ax</span><span class="p">,</span> <span class="n">Ax</span><span class="o">*</span><span class="n">Mxbad</span><span class="p">,</span> <span class="n">AxI</span><span class="p">],</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
              <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Activation Time&#39;</span><span class="p">,</span> <span class="s1">&#39;- Bad Channels&#39;</span><span class="p">,</span> <span class="s1">&#39;Interpolated Activation Time&#39;</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">])</span>

<a href="../../modules/generated/spkit.mea.mat_list_show.html#spkit.mea.mat_list_show" title="spkit.mea.mat_list_show" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mat_list_show</span></a><span class="p">([</span><span class="n">AxI</span><span class="p">,</span> <span class="n">AxIx</span><span class="p">],</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
              <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Interpolated (preserving original values)&#39;</span><span class="p">,</span> <span class="s1">&#39;Interpolation-Smooth&#39;</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_011.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_011.png" alt="Activation Time, - Bad Channels, Interpolated Activation Time" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_012.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_012.png" alt="Interpolated (preserving original values), Interpolation-Smooth" class = "sphx-glr-multi-img"/></li>
</ul>
</section>
<section id="step-13-computing-conduction-velocity-and-maps">
<h2>Step 13: Computing Conduction Velocity and maps<a class="headerlink" href="#step-13-computing-conduction-velocity-and-maps" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1">#=============STEP 13: Computing Conduction Velocity ================</span>
<span class="n">cv_param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eD</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span><span class="n">esp</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span><span class="n">cv_pad</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a><span class="p">,</span><span class="n">cv_thr</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">arr_agg</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">plots</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">CV_df</span><span class="p">,</span> <span class="n">CV_thetas</span><span class="p">,</span> <span class="n">CV0</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.compute_cv.html#spkit.mea.compute_cv" title="spkit.mea.compute_cv" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">compute_cv</span></a><span class="p">(</span><span class="n">AxI</span><span class="p">,</span><span class="n">Mxbad</span><span class="p">,</span><span class="n">flip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">cv_param</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">CV_thetas_smooth</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../../modules/generated/spkit.mea.compute_cv.html#spkit.mea.compute_cv" title="spkit.mea.compute_cv" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">compute_cv</span></a><span class="p">(</span><span class="n">AxIx</span><span class="p">,</span><span class="n">Mxbad</span><span class="p">,</span><span class="n">flip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">silent_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">cv_param</span><span class="p">)</span>



<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="matplotlib.pyplot.imshow" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">AxI</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.contour.html#matplotlib.pyplot.contour" title="matplotlib.pyplot.contour" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">contour</span></a><span class="p">(</span><span class="n">AxI</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Activation Map&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html#matplotlib.pyplot.xticks" title="matplotlib.pyplot.xticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span></a><span class="p">([])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">([])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a href="../../modules/generated/spkit.mea.mat_1_show.html#spkit.mea.mat_1_show" title="spkit.mea.mat_1_show" class="sphx-glr-backref-module-spkit-mea sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">mea</span><span class="o">.</span><span class="n">mat_1_show</span></a><span class="p">(</span><span class="n">CV</span><span class="o">*</span><span class="n">Mxbad</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;cm/s&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Cond. Velocity&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.tight_layout.html#matplotlib.pyplot.tight_layout" title="matplotlib.pyplot.tight_layout" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<span class="n">cv_arr_prop</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">_</span>  <span class="o">=</span> <a href="../../modules/generated/spkit.direction_flow_map.html#spkit.direction_flow_map" title="spkit.direction_flow_map" class="sphx-glr-backref-module-spkit sphx-glr-backref-type-py-function"><span class="n">sp</span><span class="o">.</span><span class="n">direction_flow_map</span></a><span class="p">(</span><span class="n">X_theta</span><span class="o">=</span><span class="n">CV_thetas</span><span class="p">,</span><span class="n">X</span><span class="o">=</span><span class="n">AxI</span><span class="p">,</span><span class="n">upsample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">arr_pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span>
                           <span class="n">stream_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;CV&#39;</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">heatmap_prop</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">),</span>
                           <span class="n">arr_prop</span> <span class="o">=</span><span class="n">cv_arr_prop</span><span class="p">,</span>
                           <span class="n">stream_prop</span> <span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_013.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_013.png" alt="AT, AT: dx, AT: dy" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_014.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_014.png" alt="CV-raw, CV, CV (-bad channels)" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_015.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_015.png" alt="CV | Interpolated: mean =26.82, CV | Original: mean =24.96" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_016.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_016.png" alt="CV: Compass plot, including all, CV: Compass plot, excluding bad channels" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_017.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_017.png" alt="Activation Map, Cond. Velocity" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_mea_stepwise_example_018.png" srcset="../../_images/sphx_glr_plot_mea_stepwise_example_018.png" alt="CV: Directional flow Map, CV: Streamlined flow" class = "sphx-glr-multi-img"/></li>
</ul>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 6.638 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-multielectrode-array-plot-mea-stepwise-example-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/spkit/spkit/0.9.X?urlpath=lab/tree/notebooks/auto_examples/multielectrode-array/plot_mea_stepwise_example.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo3.svg" width="150px" /></a>
</div>
<div class="lite-badge docutils container">
<a class="reference external image-reference" href="../../lite/lab/?path=auto_examples/multielectrode-array/plot_mea_stepwise_example.ipynb"><img alt="Launch JupyterLite" src="../../_images/jupyterlite_badge_logo3.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/74ca22a66ab6178356bb53e10bea90e0/plot_mea_stepwise_example.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_mea_stepwise_example.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/cb30298f34eca5de0daa06d5be261459/plot_mea_stepwise_example.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_mea_stepwise_example.py</span></code></a></p>
</div>
</div>
<p class="rubric">Related examples</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="In this example code, we demonstrate analysis of MEA Recording, with minimal settings, using si..."><img alt="" src="../../_images/sphx_glr_plot_mea_minimal_setting_example_thumb.png" />
<p><a class="reference internal" href="plot_mea_minimal_setting_example.html#sphx-glr-auto-examples-multielectrode-array-plot-mea-minimal-setting-example-py"><span class="std std-ref">MEA: Minimal Setting: Example</span></a></p>
  <div class="sphx-glr-thumbnail-title">MEA: Minimal Setting: Example</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="We are pleased to announce the release of spkit 0.0.9.7, which comes with many bug fixes, more ..."><img alt="" src="../../_images/sphx_glr_plot_release_highlights_0_0_9_7_thumb.png" />
<p><a class="reference internal" href="../release_highlights/plot_release_highlights_0_0_9_7.html#sphx-glr-auto-examples-release-highlights-plot-release-highlights-0-0-9-7-py"><span class="std std-ref">Release Highlights for spkit 0.0.9.7</span></a></p>
  <div class="sphx-glr-thumbnail-title">Release Highlights for spkit 0.0.9.7</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Dispersion Entropy is computed by first discretising the signal and then extracting all the dis..."><img alt="" src="../../_images/sphx_glr_plot_it_dispersion_entropy_top_patterns_thumb.png" />
<p><a class="reference internal" href="../information_theory/plot_it_dispersion_entropy_top_patterns.html#sphx-glr-auto-examples-information-theory-plot-it-dispersion-entropy-top-patterns-py"><span class="std std-ref">Dispersion Entropy with top patterns</span></a></p>
  <div class="sphx-glr-thumbnail-title">Dispersion Entropy with top patterns</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="     ICA Filtering algorithm uses following three criteria for removing artifacts for EEG."><img alt="" src="../../_images/sphx_glr_plot_sp_eeg_artifact_removal_ICA_thumb.png" />
<p><a class="reference internal" href="../electroencephalogram/plot_sp_eeg_artifact_removal_ICA.html#sphx-glr-auto-examples-electroencephalogram-plot-sp-eeg-artifact-removal-ica-py"><span class="std std-ref">EEG Artifact removal using ICA</span></a></p>
  <div class="sphx-glr-thumbnail-title">EEG Artifact removal using ICA</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="EEG Topographic Map"><img alt="" src="../../_images/sphx_glr_plot_sp_eeg_topomaps_thumb.png" />
<p><a class="reference internal" href="../electroencephalogram/plot_sp_eeg_topomaps.html#sphx-glr-auto-examples-electroencephalogram-plot-sp-eeg-topomaps-py"><span class="std std-ref">EEG Topographic Map</span></a></p>
  <div class="sphx-glr-thumbnail-title">EEG Topographic Map</div>
</div></div><p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


      </div>
      <div class="container">
        <footer class="spk-content-footer">
          &copy; 2019 - 2024, spkit developers (BSD License).
          <!-- -->
          <!-- <a href="../../_sources/auto_examples/multielectrode-array/plot_mea_stepwise_example.rst.txt" rel="nofollow">Show this page source</a> -->
          <!-- -->
        </footer>
      </div>

      <div class="container-fluid py-3">
        <hr>
        <div class="container spk-landing-container">
              <a class="spk-footer-funding-link" href="../../about.html">
              <div class="text-center">
                      <p class="mt-2">
                        Spkit developed in collabration with other projects:
                      </p>
                      <a href="https://PhyAAt.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../../_static/phyaat_logo.png" title="PhyAAt"></a>
                      <a href="https://PyLFSR.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../../_static/pylfsr_logo.png" title="PyLFSR" ></a>
                      <a href="https://MLEndDatasets.github.io" target="_blank"><img class="spk-footer-funding-logo" src="../../_static/mlend_logo.png" title="MLEnd-Datasets" ></a>
                      <a href='https://clustrmaps.com/site/1b9h1'  title='Visit tracker'><img src='//clustrmaps.com/map_v2.png?cl=46b0cb&w=a&t=n&d=eQr8xSBiKVuSq6m0psK-Ey9TZ7rLzjRX-MpatyfFGQI&co=ffffff&ct=000000' width="30"/></a>

              </div>
              </a>
              <!-- <div style="width:3px;">
                <a href="https://clustrmaps.com/site/1b9h1"  title="Visit tracker"><img src="//www.clustrmaps.com/map_v2.png?d=eQr8xSBiKVuSq6m0psK-Ey9TZ7rLzjRX-MpatyfFGQI&cl=ffffff" /></a>  
              </div> -->
        </div>
      </div>
    </div>
  </div>
  <script src="../../_static/js/vendor/bootstrap.min.js"></script>
  
<script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-59299155-3', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<!-- 
<script defer data-domain="scikit-learn.org" src="https://views.scientific-python.org/js/script.js">
</script>
 -->

<script src="../../_static/clipboard.min.js"></script>
<script src="../../_static/copybutton.js"></script>

<script>
$(document).ready(function() {
    /* Add a [>>>] button on the top-right corner of code samples to hide
     * the >>> and ... prompts and the output and thus make the code
     * copyable. */
    var div = $('.highlight-python .highlight,' +
                '.highlight-python3 .highlight,' +
                '.highlight-pycon .highlight,' +
		        '.highlight-default .highlight')
    var pre = div.find('pre');

    // get the styles from the current theme
    pre.parent().parent().css('position', 'relative');

    // create and add the button to all the code blocks that contain >>>
    div.each(function(index) {
        var jthis = $(this);
        // tracebacks (.gt) contain bare text elements that need to be
        // wrapped in a span to work with .nextUntil() (see later)
        jthis.find('pre:has(.gt)').contents().filter(function() {
            return ((this.nodeType == 3) && (this.data.trim().length > 0));
        }).wrap('<span>');
    });

	/*** Add permalink buttons next to glossary terms ***/
	$('dl.glossary > dt[id]').append(function() {
		return ('<a class="headerlink" href="#' +
			    this.getAttribute('id') +
			    '" title="Permalink to this term">¶</a>');
	});
});

</script>
    
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    
</body>

</html>